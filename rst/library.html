
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Opbasm PicoBlaze macro library reference &#8212; Opbasm 1.3.9 documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/project.css" type="text/css" />
    <link rel="stylesheet" href="../_static/tty/tty-player.min.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.3.9',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Opbsim" href="opbsim.html" />

   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

<script src="_static/tty/webcomponents-lite.min.js"></script>
<script src="_static/tty/term.min.js"></script>
<script src="_static/tty/tty-player.min.js"></script>

<style>
	.terminal-cursor {
		color: #000;
		background: green;
	}
	.terminal, .title {
		font-size:x-small;
	}
</style>


  </head>
  <body>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="opbasm-picoblaze-macro-library-reference">
<h1>Opbasm PicoBlaze macro library reference<a class="headerlink" href="#opbasm-picoblaze-macro-library-reference" title="Permalink to this headline">¶</a></h1>
<dl class="macro">
<dt id="pb.abs">
<code class="descname">abs</code><span class="sig-paren">(</span><em>Arg1</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.abs" title="Permalink to this definition">¶</a></dt>
<dd><p>Absolute value.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Arg1</strong> – Register to make positive</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Result is in the same register</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="nb">evalh(</span><span class="o">-</span><span class="m">10</span><span class="nb">)</span>
<span class="nb">abs(</span><span class="s">s0</span><span class="nb">)</span>             <span class="c">; Result is 10</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.abs16">
<code class="descname">abs16</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.abs16" title="Permalink to this definition">¶</a></dt>
<dd><p>16-bit absolute value.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – MSB register to make positive</li>
<li><strong>Arg2</strong> – LSB register to make positive</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Result is in Arg1, Arg2</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">load16(</span><span class="s">s1</span><span class="p">,</span><span class="s">s0</span><span class="p">,</span> <span class="o">-</span><span class="m">1000</span><span class="nb">)</span>
<span class="nb">abs16(</span><span class="s">s1</span><span class="p">,</span> <span class="s">s0</span><span class="nb">)</span>      <span class="c">; s1, s0 contain +1000</span>
<span class="nb">load16(</span><span class="s">s1</span><span class="p">,</span><span class="s">s0</span><span class="p">,</span> <span class="m">1000</span><span class="nb">)</span>
<span class="nb">abs16(</span><span class="s">s1</span><span class="p">,</span> <span class="s">s0</span><span class="nb">)</span>      <span class="c">; s1, s0 contain +1000</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.add16">
<code class="descname">add16</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em><span class="optional">[</span>, <em>Arg4</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.add16" title="Permalink to this definition">¶</a></dt>
<dd><p>16-bit addition.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Arg1</strong> – MSB1 register</li>
<li><strong>Arg2</strong> – LSB1 register</li>
<li><strong>Arg3</strong> – Decimal constant or expression or MSB2 when Arg4 is present</li>
<li><strong>Arg4</strong> – Optional register for LSB2</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Result in Arg1, Arg2</p>
</td>
</tr>
</tbody>
</table>
<p>When three arguments are passed, Arg3 is a constant literal. When four arguments are passed,
Arg3 and Arg4 are a 16-bit pair to add to the result.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">add16(</span><span class="s">s1</span><span class="p">,</span><span class="s">s0</span><span class="p">,</span> <span class="mh">0x1234</span><span class="nb">)</span> <span class="c">; s1,s0 += 0x1234</span>
<span class="nb">add16(</span><span class="s">s1</span><span class="p">,</span><span class="s">s0</span><span class="p">,</span> <span class="s">s3</span><span class="p">,</span><span class="s">s2</span><span class="nb">)</span>  <span class="c">; s1,s0 += s3,s2</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.addstack">
<code class="descname">addstack</code><span class="sig-paren">(</span><em>Arg1</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.addstack" title="Permalink to this definition">¶</a></dt>
<dd><p>Allocate local space on the stack.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Number of values to add to the stack or a register</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>You can use the added space for a local variable storage on the stack. This avoids
the need to have static stratchpad memory allocations. Use <a class="reference internal" href="#pb.dropstack" title="dropstack"><code class="xref pb pb-macro docutils literal"><span class="pre">dropstack()</span></code></a> to
restore the stack pointer.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">addstack(</span><span class="m">2</span><span class="nb">)</span>  <span class="c">; Add 2 values</span>
<span class="nb">addstack(</span><span class="s">s1</span><span class="nb">)</span> <span class="c">; Add number of values from s1</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.and16">
<code class="descname">and16</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em><span class="optional">[</span>, <em>Arg4</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.and16" title="Permalink to this definition">¶</a></dt>
<dd><p>16-bit logical AND.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Arg1</strong> – MSB1</li>
<li><strong>Arg2</strong> – LSB1</li>
<li><strong>Arg3</strong> – Decimal constant or expression or MSB2 when Arg4 is present</li>
<li><strong>Arg4</strong> – Optional register for LSB2</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Result in Arg1, Arg2</p>
</td>
</tr>
</tbody>
</table>
<p>When three arguments are passed, Arg3 is a constant literal. When four arguments are passed,
Arg3 and Arg4 are a 16-bit pair to AND to the result.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">load16(</span><span class="s">s1</span><span class="p">,</span><span class="s">s0</span><span class="p">,</span> <span class="mh">0x787F</span><span class="nb">)</span>
<span class="nb">and16(</span><span class="s">s1</span><span class="p">,</span><span class="s">s0</span><span class="p">,</span> <span class="mh">0x0FC0</span><span class="nb">)</span>  <span class="c">; Result is 0x0840</span>
<span class="nb">and16(</span><span class="s">s1</span><span class="p">,</span><span class="s">s0</span><span class="p">,</span> <span class="s">s3</span><span class="p">,</span><span class="s">s2</span><span class="nb">)</span>   <span class="c">; (s1,s0) AND (s3,s2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.ansi_black">
<code class="descname">ansi_black</code><span class="sig-paren">(</span><span class="optional">[</span><em>Arg1</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.ansi_black" title="Permalink to this definition">¶</a></dt>
<dd><p>ANSI escape codes for generating color text.</p>
<p>The resulting string contains backslash escapes that must be processed
by <a class="reference internal" href="#pb.cstr" title="cstr"><code class="xref pb pb-macro docutils literal"><span class="pre">cstr()</span></code></a> or <a class="reference internal" href="#pb.estr" title="estr"><code class="xref pb pb-macro docutils literal"><span class="pre">estr()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Optional argument of “bold” will activate bold/bright text</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="k">ansi_red</span>`foobar&#39;ansi_reset       ; red text
<span class="nb">ansi_red(</span><span class="s">bold</span><span class="nb">)</span>`foobar&#39;ansi_reset ; bold/bright red text
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.ansi_blue">
<code class="descname">ansi_blue</code><span class="sig-paren">(</span><span class="optional">[</span><em>Arg1</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.ansi_blue" title="Permalink to this definition">¶</a></dt>
<dd><p>ANSI escape codes for generating blue text.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Optional argument of “bold” will activate bold/bright text</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pb.ansi_black" title="ansi_black"><code class="xref pb pb-macro docutils literal"><span class="pre">ansi_black()</span></code></a> for more information.</p>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.ansi_cyan">
<code class="descname">ansi_cyan</code><span class="sig-paren">(</span><span class="optional">[</span><em>Arg1</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.ansi_cyan" title="Permalink to this definition">¶</a></dt>
<dd><p>ANSI escape codes for generating cyan text.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Optional argument of “bold” will activate bold/bright text</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pb.ansi_black" title="ansi_black"><code class="xref pb pb-macro docutils literal"><span class="pre">ansi_black()</span></code></a> for more information.</p>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.ansi_green">
<code class="descname">ansi_green</code><span class="sig-paren">(</span><span class="optional">[</span><em>Arg1</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.ansi_green" title="Permalink to this definition">¶</a></dt>
<dd><p>ANSI escape codes for generating green text.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Optional argument of “bold” will activate bold/bright text</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pb.ansi_black" title="ansi_black"><code class="xref pb pb-macro docutils literal"><span class="pre">ansi_black()</span></code></a> for more information.</p>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.ansi_magenta">
<code class="descname">ansi_magenta</code><span class="sig-paren">(</span><span class="optional">[</span><em>Arg1</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.ansi_magenta" title="Permalink to this definition">¶</a></dt>
<dd><p>ANSI escape codes for generating magenta text.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Optional argument of “bold” will activate bold/bright text</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pb.ansi_black" title="ansi_black"><code class="xref pb pb-macro docutils literal"><span class="pre">ansi_black()</span></code></a> for more information.</p>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.ansi_red">
<code class="descname">ansi_red</code><span class="sig-paren">(</span><span class="optional">[</span><em>Arg1</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.ansi_red" title="Permalink to this definition">¶</a></dt>
<dd><p>ANSI escape codes for generating red text.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Optional argument of “bold” will activate bold/bright text</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pb.ansi_black" title="ansi_black"><code class="xref pb pb-macro docutils literal"><span class="pre">ansi_black()</span></code></a> for more information.</p>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.ansi_reset">
<code class="descname">ansi_reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.ansi_reset" title="Permalink to this definition">¶</a></dt>
<dd><p>ANSI escape code for clearing pervious colors.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pb.ansi_black" title="ansi_black"><code class="xref pb pb-macro docutils literal"><span class="pre">ansi_black()</span></code></a> for more information.</p>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.ansi_white">
<code class="descname">ansi_white</code><span class="sig-paren">(</span><span class="optional">[</span><em>Arg1</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.ansi_white" title="Permalink to this definition">¶</a></dt>
<dd><p>ANSI escape codes for generating white text.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Optional argument of “bold” will activate bold/bright text</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pb.ansi_black" title="ansi_black"><code class="xref pb pb-macro docutils literal"><span class="pre">ansi_black()</span></code></a> for more information.</p>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.ansi_yellow">
<code class="descname">ansi_yellow</code><span class="sig-paren">(</span><span class="optional">[</span><em>Arg1</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.ansi_yellow" title="Permalink to this definition">¶</a></dt>
<dd><p>ANSI escape codes for generating yellow text.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Optional argument of “bold” will activate bold/bright text</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pb.ansi_black" title="ansi_black"><code class="xref pb pb-macro docutils literal"><span class="pre">ansi_black()</span></code></a> for more information.</p>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.argc">
<code class="descname">argc</code><span class="sig-paren">(</span><em>Arg1-ArgN</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.argc" title="Permalink to this definition">¶</a></dt>
<dd><p>Count the number of args.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1-ArgN</strong> – Argument list to count</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">argc(</span><span class="s">a</span><span class="p">,</span><span class="s">b</span><span class="p">,</span><span class="s">c</span><span class="p">,</span><span class="s">d</span><span class="nb">)</span> <span class="c">; Expands to 4</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.asciiord">
<code class="descname">asciiord</code><span class="sig-paren">(</span><em>Arg1</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.asciiord" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a string to a list of decimal ASCII codes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – String to convert</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">asciiord(</span><span class="s">`My</span> <span class="s">string&#39;</span><span class="nb">)</span>  <span class="c">; Expands to 77, 121, 32, 115, 116, 114, 105, 110, 103</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You must use m4 quotes on the string argument to avoid unwanted substitutions.</p>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.break">
<code class="descname">break</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.break" title="Permalink to this definition">¶</a></dt>
<dd><p>Break statement to exit from for(), while(), and dowhile() loops.</p>
</dd></dl>

<dl class="macro">
<dt id="pb.calleq">
<code class="descname">calleq</code><span class="sig-paren">(</span><em>Arg1</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.calleq" title="Permalink to this definition">¶</a></dt>
<dd><p>Call if equal.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Label to call</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="macro">
<dt id="pb.callge">
<code class="descname">callge</code><span class="sig-paren">(</span><em>Arg1</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.callge" title="Permalink to this definition">¶</a></dt>
<dd><p>Call if greater or equal.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Label to call</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="k">compare</span> <span class="n">s3</span><span class="p">,</span> <span class="mh">24</span>
<span class="nb">callge(</span><span class="s">greater</span><span class="nb">)</span>    <span class="c">; call if s3 &gt;= 24</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.calllt">
<code class="descname">calllt</code><span class="sig-paren">(</span><em>Arg1</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.calllt" title="Permalink to this definition">¶</a></dt>
<dd><p>Call if less than.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Label to call</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="macro">
<dt id="pb.callne">
<code class="descname">callne</code><span class="sig-paren">(</span><em>Arg1</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.callne" title="Permalink to this definition">¶</a></dt>
<dd><p>Call if not equal.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Label to call</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="k">compare</span> <span class="n">s3</span><span class="p">,</span> <span class="mh">24</span>
<span class="nb">callne(</span><span class="s">not_equal</span><span class="nb">)</span>  <span class="c">; call if s3 != 24</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.callstring">
<code class="descname">callstring</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.callstring" title="Permalink to this definition">¶</a></dt>
<dd><p>Repeated string function call operation (useful for PicoBlaze-3).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Subroutine to call for each character</li>
<li><strong>Arg2</strong> – Register used to hold characters (typically an argument to the subroutine)</li>
<li><strong>Arg3</strong> – String to split into characters</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">callstring(</span><span class="s">write_char</span><span class="p">,</span> <span class="s">s1</span><span class="p">,</span> <span class="s">`My</span> <span class="s">string&#39;</span><span class="nb">)</span>
<span class="k">Expands</span> <span class="n">to</span>:
   <span class="k">load</span> <span class="n">s1</span><span class="p">,</span> <span class="sc">&quot;M&quot;</span>
   <span class="k">call</span> <span class="n">write_char</span>
   <span class="k">load</span> <span class="n">s1</span><span class="p">,</span> <span class="sc">&quot;y&quot;</span>
   <span class="k">call</span> <span class="n">write_char</span>
   ...
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.calltable">
<code class="descname">calltable</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3-ArgN</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.calltable" title="Permalink to this definition">¶</a></dt>
<dd><p>Repeated function call on a table of constants.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Subroutine to call for each byte</li>
<li><strong>Arg2</strong> – Temporary register for each constant</li>
<li><strong>Arg3-ArgN</strong> – Decimal values representing table bytes</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">calltable(</span><span class="s">my_subroutine</span><span class="p">,</span> <span class="s">sF</span><span class="p">,</span> <span class="nb">pbhex(</span><span class="mh">DE</span><span class="p">,</span><span class="mh">AD</span><span class="p">,</span><span class="mh">BE</span><span class="p">,</span><span class="mh">EF</span><span class="nb">))</span> <span class="c">; Pass DE,AD,BE,EF in repeated calls to my_subroutine</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.clearcy">
<code class="descname">clearcy</code><span class="sig-paren">(</span><span class="optional">[</span><em>Arg1</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.clearcy" title="Permalink to this definition">¶</a></dt>
<dd><p>Clear the carry flag.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Optional temp register</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="k">clearcy</span>
<span class="nb">clearcy(</span><span class="s">s0</span><span class="nb">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.clearmask">
<code class="descname">clearmask</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.clearmask" title="Permalink to this definition">¶</a></dt>
<dd><p>Clear mask bits in a register.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Register to modify</li>
<li><strong>Arg2</strong> – Mask value</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">clearmask(</span><span class="s">s5</span><span class="p">,</span> <span class="nb">mask(</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="nb">))</span>
<span class="nb">clearmask(</span><span class="s">s4</span><span class="p">,</span> <span class="mh">0xF1</span><span class="nb">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.colorize">
<code class="descname">colorize</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em><span class="optional">[</span>, <em>Arg3</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.colorize" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrap a string in ANSI color codes.</p>
<p>The resulting string contains backslash escapes that must be processed
by <a class="reference internal" href="#pb.cstr" title="cstr"><code class="xref pb pb-macro docutils literal"><span class="pre">cstr()</span></code></a> or <a class="reference internal" href="#pb.estr" title="estr"><code class="xref pb pb-macro docutils literal"><span class="pre">estr()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – String to modify</li>
<li><strong>Arg2</strong> – ANSI color name (black, red, green, yellow, blue, magenta, cyan, and white)</li>
<li><strong>Arg3</strong> – Optional argument “bold” will select bold text</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">colorize(</span><span class="s">`foobar&#39;</span><span class="p">,</span> <span class="s">blue</span><span class="nb">)</span>      <span class="c">; Equivalent to ansi_blue`foobar&#39;ansi_reset</span>
<span class="nb">colorize(</span><span class="s">`foobar&#39;</span><span class="p">,</span> <span class="s">red</span><span class="p">,</span> <span class="s">bold</span><span class="nb">)</span> <span class="c">; Equivalent to ansi_red(bold)`foobar&#39;ansi_reset</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.compares">
<code class="descname">compares</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.compares" title="Permalink to this definition">¶</a></dt>
<dd><p>Signed compare.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Register for left side of comparison</li>
<li><strong>Arg2</strong> – Register or constant for right side of comparison.
Constant is a number in m4 syntax and cannot be a named constant</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Carry flag is set in accordance with signed relation.</p>
<p>Zero flag is indeterminate. Use normal <a class="reference internal" href="language.html#inst-compare"><span class="std std-ref">compare</span></a> instruction for == and !=</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This calls the <a class="reference internal" href="#pb.setcy" title="setcy"><code class="xref pb pb-macro docutils literal"><span class="pre">setcy()</span></code></a> macro and depends on the tempreg</p>
</div>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="nb">evalh(</span><span class="o">-</span><span class="m">20</span><span class="nb">)</span>
<span class="k">load</span> <span class="n">s1</span><span class="p">,</span> <span class="mh">42</span>
<span class="nb">compares(</span><span class="s">s0</span><span class="p">,</span> <span class="s">s1</span><span class="nb">)</span>     <span class="c">; C flag is set because -20 &lt; 0x42</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.constlower">
<code class="descname">constlower</code><span class="sig-paren">(</span><em>Arg1</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.constlower" title="Permalink to this definition">¶</a></dt>
<dd><p>Split a 16-bit constant and return its lower byte.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Constant to split</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">constlower(</span><span class="mh">0x1234</span><span class="nb">)</span> <span class="c">; Expands to 0x34</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.constupper">
<code class="descname">constupper</code><span class="sig-paren">(</span><em>Arg1</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.constupper" title="Permalink to this definition">¶</a></dt>
<dd><p>Split a 16-bit constant and return its upper byte.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Constant to split</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">constupper(</span><span class="mh">0x1234</span><span class="nb">)</span> <span class="c">; Expands to 0x12</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.continue">
<code class="descname">continue</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.continue" title="Permalink to this definition">¶</a></dt>
<dd><p>Continue statement to restart a for(), while(), or dowhile() loop.</p>
</dd></dl>

<dl class="macro">
<dt id="pb.cstr">
<code class="descname">cstr</code><span class="sig-paren">(</span><em>Arg1</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.cstr" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a string to a list of decimal ASCII codes with a NUL terminator.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – String to convert</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pb.estr" title="estr"><code class="xref pb pb-macro docutils literal"><span class="pre">estr()</span></code></a> for more information.</p>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.dec2pbhex">
<code class="descname">dec2pbhex</code><span class="sig-paren">(</span><em>Arg1-ArgN</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.dec2pbhex" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a list of decimal values to PicoBlaze hex format.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1-ArgN</strong> – Decimal values to convert</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">dec2pbhex(</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">100</span><span class="p">,</span> <span class="m">200</span><span class="nb">)</span>  <span class="c">; Expands to 01, 02, 64, C8</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.delay_cycles">
<code class="descname">delay_cycles</code><span class="sig-paren">(</span><em>Arg1</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.delay_cycles" title="Permalink to this definition">¶</a></dt>
<dd><p>Delay for a number of instruction cycles.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Number of instructions to delay</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>This can generate two types of delay loops. The default is a recursive
delay implemented without any registers. For delays of 511 cycles or less
a more efficient loop can be generated if a loop count register is defined
first by calling the <a class="reference internal" href="#pb.use_delay_reg" title="use_delay_reg"><code class="xref pb pb-macro docutils literal"><span class="pre">use_delay_reg()</span></code></a> macro.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">delay_cycles(</span><span class="m">10</span><span class="nb">)</span> <span class="c">; Delay for 10 instructions (20 clock cycles)</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.delay_ms">
<code class="descname">delay_ms</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em><span class="optional">[</span>, <em>Arg4</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.delay_ms" title="Permalink to this definition">¶</a></dt>
<dd><p>Delay by milliseconds.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Milliseconds to delay</li>
<li><strong>Arg2</strong> – MSB register of delay counter</li>
<li><strong>Arg3</strong> – LSB register of delay counter</li>
<li><strong>Arg4</strong> – Optional number of instructions to deduct from the delay (default is 0)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>This delay will be cycle accurate if the requested delay is an integer multiple
of the clock period.
At 100 MHz, the max delay is 214 ms. It increases with lower clock frequencies.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre> <span class="nb">use_clock(</span><span class="m">50</span><span class="nb">)</span> <span class="c">; 50 MHz clock</span>

<span class="nl">delay_5ms:</span> <span class="nb">delay_ms(</span><span class="m">5</span><span class="p">,</span> <span class="s">s4</span><span class="p">,</span><span class="s">s5</span><span class="p">,</span> <span class="m">2</span><span class="nb">)</span> <span class="c">; Deduct 2 additional instructions to account for call and return</span>
           <span class="k">return</span>
...
<span class="k">call</span> <span class="n">delay_5ms</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.delay_us">
<code class="descname">delay_us</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em><span class="optional">[</span>, <em>Arg4</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.delay_us" title="Permalink to this definition">¶</a></dt>
<dd><p>Delay by microseconds.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Microseconds to delay</li>
<li><strong>Arg2</strong> – MSB register of delay counter</li>
<li><strong>Arg3</strong> – LSB register of delay counter</li>
<li><strong>Arg4</strong> – Optional number of instructions to deduct from the delay (default is 0)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>This delay will be cycle accurate if the requested delay is an integer multiple
of the clock period.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre> <span class="nb">use_clock(</span><span class="m">50</span><span class="nb">)</span> <span class="c">; 50 MHz clock</span>

<span class="nl">delay_40us:</span> <span class="nb">delay_us(</span><span class="m">40</span><span class="p">,</span> <span class="s">s4</span><span class="p">,</span><span class="s">s5</span><span class="nb">)</span>
            <span class="k">return</span>
...
<span class="k">call</span> <span class="n">delay_40us</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.dowhile">
<code class="descname">dowhile</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.dowhile" title="Permalink to this definition">¶</a></dt>
<dd><p>Do-while loop.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Boolean comparison expression</li>
<li><strong>Arg2</strong> – Code block for loop body</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The Boolean expression must be of the form: <code class="docutils literal"><span class="pre">reg</span> <span class="pre">op</span> <span class="pre">reg|expression</span></code> where op is &lt;, &gt;=, ==, !=, &amp;, or ~&amp;</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="m">15&#39;d</span>
<span class="nb">dowhile(</span><span class="s">s0</span> <span class="o">!=</span> <span class="m">10</span><span class="p">,</span> <span class="s">`output</span> <span class="s">s3</span><span class="p">,</span> <span class="s">P_foo</span>
                   <span class="s">sub</span> <span class="s">s0</span><span class="p">,</span> <span class="m">01</span><span class="s">&#39;</span><span class="nb">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.dropstack">
<code class="descname">dropstack</code><span class="sig-paren">(</span><em>Arg1</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.dropstack" title="Permalink to this definition">¶</a></dt>
<dd><p>Drop values stored on the stack.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Number of values to drop from the stack or a register</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">dropstack(</span><span class="m">2</span><span class="nb">)</span>  <span class="c">; Remove 2 values</span>
<span class="nb">dropstack(</span><span class="s">s1</span><span class="nb">)</span> <span class="c">; Remove number of values specified in s1 register</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.errmsg">
<code class="descname">errmsg</code><span class="sig-paren">(</span><em>Arg1</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.errmsg" title="Permalink to this definition">¶</a></dt>
<dd><p>Print an error message and terminate m4.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – message string</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>This prints a message with the file and line number where the macro was invoked for debugging.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">errmsg(</span><span class="s">`Bad</span> <span class="s">arguments</span> <span class="s">to</span> <span class="s">foo</span> <span class="s">macro&#39;</span><span class="nb">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.estr">
<code class="descname">estr</code><span class="sig-paren">(</span><em>Arg1</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.estr" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a string to a list of decimal ASCII codes without a NUL terminator.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – String to convert</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The following C escape codes are translated to their ASCII value:</p>
<ul class="simple">
<li>\  \</li>
<li>\n  NL\LF</li>
<li>\r  CR</li>
<li>\t  HT</li>
<li>\b  BS</li>
<li>\a  BEL</li>
<li>\e  ESC</li>
<li>\s  semicolon ;</li>
</ul>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">estr(</span><span class="s">`My</span> <span class="s">string\r\n&#39;</span><span class="nb">)</span>  <span class="c">; Expands to 77, 121, 32, 115, 116, 114, 105, 110, 103, 13, 10</span>
<span class="nb">cstr(</span><span class="s">`My</span> <span class="s">string\r\n&#39;</span><span class="nb">)</span>  <span class="c">; Expands to 77, 121, 32, 115, 116, 114, 105, 110, 103, 13, 10, 0</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.evala">
<code class="descname">evala</code><span class="sig-paren">(</span><em>Arg1</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.evala" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate m4 expression as a 12-bit PicoBlaze address.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Arg1</strong> – Expression</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Expands to a PicoBlaze address literal with a comment listing the original expression</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="macro">
<dt id="pb.evalb">
<code class="descname">evalb</code><span class="sig-paren">(</span><em>Arg1</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.evalb" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate m4 expression as a PicoBlaze binary number.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Arg1</strong> – Expression or constant name</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Expands to a PicoBlaze binary literal with a comment listing the original expression</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="macro">
<dt id="pb.evalc">
<code class="descname">evalc</code><span class="sig-paren">(</span><em>Arg1</em><span class="optional">[</span>, <em>Arg2</em>, <em>Arg3</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.evalc" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate m4 expression with expansion of constants.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Arg1</strong> – Expression or constant name</li>
<li><strong>Arg2</strong> – Optional numeric base to convert to (default is 10)</li>
<li><strong>Arg3</strong> – Optional minimum number of digits in result (default is 0)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Expands to a literal for the expression or constant</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="macro">
<dt id="pb.evald">
<code class="descname">evald</code><span class="sig-paren">(</span><em>Arg1</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.evald" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate m4 expression as a PicoBlaze decimal number.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Arg1</strong> – Expression or constant name</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Expands to a PicoBlaze decimal literal with a comment listing the original expression</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="k">constant</span> <span class="n">cname</span><span class="p">,</span> <span class="nb">evald(</span><span class="m">20</span> <span class="o">*</span> <span class="m">4</span> <span class="o">-</span> <span class="m">1</span><span class="nb">)</span>  --&gt;  constant cname, 79&#39;d
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.evalh">
<code class="descname">evalh</code><span class="sig-paren">(</span><em>Arg1</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.evalh" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate m4 expression as an 8-bit PicoBlaze hex number.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Arg1</strong> – Expression or constant name</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Expands to a PicoBlaze hex literal with a comment listing the original expression</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="k">constant</span> <span class="n">cname</span><span class="p">,</span>  <span class="nb">evalh(</span><span class="m">20</span> <span class="o">+</span> <span class="m">6</span><span class="nb">)</span>      --&gt;  constant cname,  1a
<span class="k">constant</span> <span class="n">cname2</span><span class="p">,</span> <span class="nb">evalh(</span><span class="m">250</span> <span class="o">+</span> <span class="m">6</span><span class="nb">)</span>     --&gt;  constant cname2, 01
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.evalx">
<code class="descname">evalx</code><span class="sig-paren">(</span><em>Arg1</em><span class="optional">[</span>, <em>Arg2</em>, <em>Arg3</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.evalx" title="Permalink to this definition">¶</a></dt>
<dd><p>Only evaluate valid expressions, otherwise reproduce the original text in the
first argument.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Expression or string literal</li>
<li><strong>Arg2</strong> – Optional numeric base to convert to (default is 10)</li>
<li><strong>Arg3</strong> – Optional minimum number of digits in result (default is 0)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">evalx(</span><span class="s">some_name</span><span class="nb">)</span>  --&gt; some_name
<span class="nb">evalx(</span><span class="m">1</span><span class="o">+</span><span class="m">3</span><span class="nb">)</span>        --&gt; 4
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.expr">
<code class="descname">expr</code><span class="sig-paren">(</span><em>Arg1</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.expr" title="Permalink to this definition">¶</a></dt>
<dd><p>Expression evaluators
This is a family of macros that provide implementation of arithmetic expressions from
compact input notation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Register assignment expression of the form:
sN := &lt;val&gt; op &lt;val&gt; [op &lt;val&gt;]*</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>val is one of:</p>
<ul class="simple">
<li>register</li>
<li>literal expression (with no internal spaces)</li>
<li>sp[addr] scratchpad adddress</li>
<li>spi[reg] indirect scratchpad address in register</li>
</ul>
<p>op is one of:</p>
<blockquote>
<div><dl class="docutils">
<dt><cite>+ - * /</cite></dt>
<dd>add, subtract, multiply, divide</dd>
<dt><cite>&amp; | ^</cite></dt>
<dd>and, or, xor</dd>
<dt><cite>&lt;&lt; &gt;&gt;</cite></dt>
<dd>shift left, shift right (0-filled MSB)</dd>
<dt><cite>=:</cite></dt>
<dd>reverse assignment to register or scratchpad</dd>
</dl>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Operations are evaluated left to right with <strong>no precedence</strong></p>
</div>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">expr(</span><span class="s">s0</span> <span class="o">:=</span> <span class="s">s1</span> <span class="o">+</span> <span class="s">s2</span> <span class="o">-</span> <span class="s">s3</span> <span class="o">&gt;&gt;</span> <span class="m">4</span> <span class="o">=:</span> <span class="s">sp[M_value]</span><span class="nb">)</span>
  <span class="k">Arithmetic</span> <span class="n">is</span> <span class="n">performed</span> <span class="n">on</span> <span class="n">s0</span> <span class="n">and</span> <span class="n">the</span> <span class="n">result</span> <span class="n">is</span> <span class="n">stored</span> <span class="n">in</span> <span class="n">scratchpad</span> <span class="n">at</span> <span class="n">M_value</span>
  <span class="k">s0</span> &lt;= s1, s0 &lt;= s0 + s2, s0 &lt;= s0 - s3, s0 &lt;= s0 &gt;&gt; 4, sp[M_value] &lt;= s0

<span class="nb">expr(</span><span class="s">s1</span> <span class="o">:=</span> <span class="s">s4</span> <span class="o">+</span> <span class="s">(28*4-1</span><span class="nb">)</span>)
  <span class="k">s1</span> &lt;= s4, s1 &lt;= s1 + 111   Constant expressions must have no spaces
</pre></div>
</div>
<p>Summary of expression macros:</p>
<table border="1" class="docutils">
<colgroup>
<col width="8%" />
<col width="20%" />
<col width="41%" />
<col width="31%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Macro</th>
<th class="head">Target x operand</th>
<th class="head">Supported operators</th>
<th class="head">Notes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>expr</td>
<td>8x8</td>
<td><code class="docutils literal"><span class="pre">+,</span> <span class="pre">-,</span> <span class="pre">*,</span> <span class="pre">/,</span> <span class="pre">&amp;,</span> <span class="pre">|,</span> <span class="pre">^,</span> <span class="pre">&lt;&lt;,</span> <span class="pre">&gt;&gt;,</span> <span class="pre">=:</span></code></td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>exprs</td>
<td>8x8</td>
<td><code class="docutils literal"><span class="pre">+,</span> <span class="pre">-,</span> <span class="pre">*,</span> <span class="pre">/,</span> <span class="pre">&amp;,</span> <span class="pre">|,</span> <span class="pre">^,</span> <span class="pre">&lt;&lt;,</span> <span class="pre">&gt;&gt;,</span> <span class="pre">=:</span></code></td>
<td>(signed *, /, and &gt;&gt;)</td>
</tr>
<tr class="row-even"><td>expr2</td>
<td>16x8 (see note)</td>
<td><code class="docutils literal"><span class="pre">+,</span> <span class="pre">-,</span> <span class="pre">*,</span> <span class="pre">/,</span> <span class="pre">&lt;&lt;,</span> <span class="pre">&gt;&gt;,</span> <span class="pre">=:</span></code></td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>expr2s</td>
<td>16x8 (see note)</td>
<td><code class="docutils literal"><span class="pre">+,</span> <span class="pre">-,</span> <span class="pre">*,</span> <span class="pre">/,</span> <span class="pre">&lt;&lt;,</span> <span class="pre">&gt;&gt;,</span> <span class="pre">=:</span></code></td>
<td>(signed for all except &lt;&lt;)</td>
</tr>
<tr class="row-even"><td>expr16</td>
<td>16x16</td>
<td><code class="docutils literal"><span class="pre">+,</span> <span class="pre">-,</span> <span class="pre">&amp;,</span> <span class="pre">|,</span> <span class="pre">^,</span> <span class="pre">&lt;&lt;,</span> <span class="pre">&gt;&gt;,</span> <span class="pre">=:</span></code></td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>expr16s</td>
<td>16x16</td>
<td><code class="docutils literal"><span class="pre">+,</span> <span class="pre">-,</span> <span class="pre">&amp;,</span> <span class="pre">|,</span> <span class="pre">^,</span> <span class="pre">&lt;&lt;,</span> <span class="pre">&gt;&gt;,</span> <span class="pre">=:</span></code></td>
<td>(signed &gt;&gt;)</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The expr2 macros support 16-bit literals as operands of + and -</p>
</div>
<p>For multiplication and division support you must initialize the internal functions with
one of the following:</p>
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="60%" />
<col width="28%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Macro</th>
<th class="head">Multiply</th>
<th class="head">Divide</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>expr</td>
<td>use_expr_mul</td>
<td>use_expr_div</td>
</tr>
<tr class="row-odd"><td>exprs</td>
<td>use_expr_muls</td>
<td>use_expr_divs</td>
</tr>
<tr class="row-even"><td>expr2</td>
<td>use_expr_mul</td>
<td>use_expr_div16</td>
</tr>
<tr class="row-odd"><td>expr2s</td>
<td>use_expr_muls and use_expr_mulsu</td>
<td>use_expr_div16s</td>
</tr>
</tbody>
</table>
<p>As an expedient you can invoke <a class="reference internal" href="#pb.use_expr_all" title="use_expr_all"><code class="xref pb pb-macro docutils literal"><span class="pre">use_expr_all()</span></code></a> to include all of them and then
eliminate any unused mul or div routines with the <code class="docutils literal"><span class="pre">--remove-dead-code</span></code> option to opbasm.</p>
<p>These macros need to be called before any call to expr*() that uses multiplication or division.
It is best to place them at the start of the program and jump over them to reach the startup code.
The stack must be configured with <a class="reference internal" href="#pb.use_stack" title="use_stack"><code class="xref pb pb-macro docutils literal"><span class="pre">use_stack()</span></code></a> before calling these macros because additional
modified registers must be saved and restored.</p>
<p>By default these macros configure the mul and div functions to use the s8,s9 or s7,s8, and s9
registers for input and output. You can modify the register allocation by passing arguments
to the use_* macros. The MSB of multiplication is ignored by subsequent operations. Division
by 0 is not detected.</p>
</dd></dl>

<dl class="macro">
<dt id="pb.expr16">
<code class="descname">expr16</code><span class="sig-paren">(</span><em>Arg1</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.expr16" title="Permalink to this definition">¶</a></dt>
<dd><p>16x16 unsigned expression evaluator.
All terms are 16-bit register pairs or 16-bit literals.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Register assignment expression of the form:
sN := &lt;val&gt; op &lt;val&gt; [op &lt;val&gt;]*</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pb.expr" title="expr"><code class="xref pb pb-macro docutils literal"><span class="pre">expr()</span></code></a> for more information.</p>
</div>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">reg16(</span><span class="s">rx</span><span class="p">,</span> <span class="s">s4</span><span class="p">,</span><span class="s">s5</span><span class="nb">)</span>
<span class="nb">reg16(</span><span class="s">ry</span><span class="p">,</span> <span class="s">s6</span><span class="p">,</span><span class="s">s7</span><span class="nb">)</span>
<span class="nb">load16(</span><span class="s">ry</span><span class="p">,</span> <span class="m">400</span><span class="nb">)</span>
<span class="nb">expr2(</span><span class="s">rx</span> <span class="o">:=</span> <span class="m">2000</span> <span class="o">+</span> <span class="s">ry</span> <span class="o">*</span> <span class="m">3</span><span class="nb">)</span>  <span class="c">; (2000 + 400) * 3 =&gt; 12600</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.expr16s">
<code class="descname">expr16s</code><span class="sig-paren">(</span><em>Arg1</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.expr16s" title="Permalink to this definition">¶</a></dt>
<dd><p>16x16 signed expression evaluator.
All terms are 16-bit register pairs or 16-bit literals.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Register assignment expression of the form:
sN := &lt;val&gt; op &lt;val&gt; [op &lt;val&gt;]*</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pb.expr" title="expr"><code class="xref pb pb-macro docutils literal"><span class="pre">expr()</span></code></a> for more information.</p>
</div>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">reg16(</span><span class="s">rx</span><span class="p">,</span> <span class="s">s4</span><span class="p">,</span><span class="s">s5</span><span class="nb">)</span>
<span class="nb">reg16(</span><span class="s">ry</span><span class="p">,</span> <span class="s">s6</span><span class="p">,</span><span class="s">s7</span><span class="nb">)</span>
<span class="nb">load16(</span><span class="s">ry</span><span class="p">,</span> <span class="o">-</span><span class="m">400</span><span class="nb">)</span>
<span class="nb">expr2(</span><span class="s">rx</span> <span class="o">:=</span> <span class="m">2000</span> <span class="o">+</span> <span class="s">ry</span> <span class="o">*</span> <span class="o">-</span><span class="m">3</span><span class="nb">)</span>  <span class="c">; (2000 + -400) * -3 =&gt; -4800</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.expr2">
<code class="descname">expr2</code><span class="sig-paren">(</span><em>Arg1</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.expr2" title="Permalink to this definition">¶</a></dt>
<dd><p>16x8 unsigned expression evaluator.
The target register is a 16-bit pair and the first term can be a 16-bit pair
or a 16-bit literal.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Register assignment expression of the form:
sN := &lt;val&gt; op &lt;val&gt; [op &lt;val&gt;]*</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pb.expr" title="expr"><code class="xref pb pb-macro docutils literal"><span class="pre">expr()</span></code></a> for more information.</p>
</div>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">reg16(</span><span class="s">rx</span><span class="p">,</span> <span class="s">s4</span><span class="p">,</span><span class="s">s5</span><span class="nb">)</span>
<span class="nb">reg16(</span><span class="s">ry</span><span class="p">,</span> <span class="s">s6</span><span class="p">,</span><span class="s">s7</span><span class="nb">)</span>
<span class="nb">load16(</span><span class="s">ry</span><span class="p">,</span> <span class="m">400</span><span class="nb">)</span>
<span class="nb">expr2(</span><span class="s">rx</span> <span class="o">:=</span> <span class="s">ry</span> <span class="o">+</span> <span class="m">200</span> <span class="o">*</span> <span class="m">3</span><span class="nb">)</span>  <span class="c">; (400 + 200) * 3 =&gt; 1800</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.expr2s">
<code class="descname">expr2s</code><span class="sig-paren">(</span><em>Arg1</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.expr2s" title="Permalink to this definition">¶</a></dt>
<dd><p>16x8 signed expression evaluator.
The target register is a 16-bit pair and the first term can be a 16-bit pair
or a 16-bit literal.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Register assignment expression of the form:
sN := &lt;val&gt; op &lt;val&gt; [op &lt;val&gt;]*</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pb.expr" title="expr"><code class="xref pb pb-macro docutils literal"><span class="pre">expr()</span></code></a> for more information.</p>
</div>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">reg16(</span><span class="s">rx</span><span class="p">,</span> <span class="s">s4</span><span class="p">,</span><span class="s">s5</span><span class="nb">)</span>
<span class="nb">reg16(</span><span class="s">ry</span><span class="p">,</span> <span class="s">s6</span><span class="p">,</span><span class="s">s7</span><span class="nb">)</span>
<span class="nb">load16(</span><span class="s">ry</span><span class="p">,</span> <span class="o">-</span><span class="m">400</span><span class="nb">)</span>
<span class="nb">expr2(</span><span class="s">rx</span> <span class="o">:=</span> <span class="s">ry</span> <span class="o">+</span> <span class="m">200</span> <span class="o">*</span> <span class="o">-</span><span class="m">3</span><span class="nb">)</span>  <span class="c">; (-400 + 200) * -3 =&gt; 600</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.exprs">
<code class="descname">exprs</code><span class="sig-paren">(</span><em>Arg1</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.exprs" title="Permalink to this definition">¶</a></dt>
<dd><p>Signed 8-bit expression evaluator.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Register assignment expression of the form:
sN := &lt;val&gt; op &lt;val&gt; [op &lt;val&gt;]*</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pb.expr" title="expr"><code class="xref pb pb-macro docutils literal"><span class="pre">expr()</span></code></a> for more information.</p>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.fetch16">
<code class="descname">fetch16</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em><span class="optional">[</span>, <em>Arg4</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.fetch16" title="Permalink to this definition">¶</a></dt>
<dd><p>16-bit fetch.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Arg1</strong> – MSB register of target</li>
<li><strong>Arg2</strong> – LSB register of target</li>
<li><strong>Arg3</strong> – Register pointing to low byte or MSB of source address when Arg4 is present</li>
<li><strong>Arg4</strong> – Optional register for LSB of source address</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Result in Arg1, Arg2</p>
</td>
</tr>
</tbody>
</table>
<p>When three arguments are passed, Arg3 is a register pointing to the low byte to fetch.
It is incremented twice to permit sequential use of fetch16().
When four arguments are passed, Arg3 and Arg4 are a 16-bit pair of address constants to fetch from.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="k">constant</span> <span class="n">M_ACCUM_L</span><span class="p">,</span> <span class="mh">1a</span>
<span class="k">constant</span> <span class="n">M_ACCUM_H</span><span class="p">,</span> <span class="mh">1b</span>
<span class="nb">reg16(</span><span class="s">M_ACCUM</span><span class="p">,</span> <span class="s">M_ACCUM_H</span><span class="p">,</span> <span class="s">M_ACCUM_L</span><span class="nb">)</span>
<span class="nb">reg16(</span><span class="s">rx</span><span class="p">,</span> <span class="s">s4</span><span class="p">,</span> <span class="s">s3</span><span class="nb">)</span>
<span class="nb">fetch16(</span><span class="s">rx</span><span class="p">,</span> <span class="s">M_ACCUM</span><span class="nb">)</span>  <span class="c">; Fetch direct from address</span>
<span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="n">M_ACCUM_L</span>
<span class="nb">fetch16(</span><span class="s">rx</span><span class="p">,</span> <span class="s">s0</span><span class="nb">)</span>       <span class="c">; Fetch from indirect pointer</span>
<span class="nb">fetch16(</span><span class="s">rx</span><span class="p">,</span> <span class="s">s0</span><span class="nb">)</span>       <span class="c">; Fetch next word</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.floor_log">
<code class="descname">floor_log</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.floor_log" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute floor(log(n,b)) for Base-b.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Number to compute floor-log on</li>
<li><strong>Arg2</strong> – Logarithm base</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">floor_log(</span><span class="m">20</span><span class="p">,</span> <span class="m">2</span><span class="nb">)</span>    <span class="c">; Expands to 4 (2**4 = 16, 2**5 = 32)</span>
<span class="nb">floor_log(</span><span class="m">1000</span><span class="p">,</span> <span class="m">10</span><span class="nb">)</span> <span class="c">; Expands to 3 (10**3 = 1000)</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.floor_log2">
<code class="descname">floor_log2</code><span class="sig-paren">(</span><em>Arg1</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.floor_log2" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute floor(log(n)) for Base-2.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Number to compute floor-log on</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">floor_log2(</span><span class="m">64</span><span class="nb">)</span> <span class="c">; Expands to 6</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.for">
<code class="descname">for</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em>, <em>Arg4</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.for" title="Permalink to this definition">¶</a></dt>
<dd><p>For loop.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Initialization expression (passed to expr()). This can be empty.</li>
<li><strong>Arg2</strong> – Boolean comparison expression</li>
<li><strong>Arg3</strong> – Update expression (passed to expr()). This can be empty.</li>
<li><strong>Arg4</strong> – Code block for loop body</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">for(</span><span class="s">s0</span> <span class="o">:=</span> <span class="m">0</span><span class="p">,</span> <span class="s">s0</span> <span class="o">&lt;</span> <span class="m">5</span><span class="p">,</span> <span class="s">s0</span> <span class="o">:=</span> <span class="s">s0</span> <span class="o">+</span> <span class="m">1</span><span class="p">,</span> <span class="s">`output</span> <span class="s">s0</span><span class="p">,</span> <span class="m">00</span><span class="s">&#39;</span><span class="nb">)</span>
</pre></div>
</div>
<p>Note:
The <a class="reference internal" href="#pb.continue" title="continue"><code class="xref pb pb-macro docutils literal"><span class="pre">continue</span></code></a> macro will behave as in C by jumping to the update code before
restarting the loop.</p>
</dd></dl>

<dl class="macro">
<dt id="pb.func">
<code class="descname">func</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em>, <em>Arg4</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.func" title="Permalink to this definition">¶</a></dt>
<dd><p>Function definition.</p>
<p>This creates a function that receives its arguments on the stack.
A macro is generated to prepare the stack arguments and call the function.
The function will save registers automatically and load the stack arguments.
The saved registers and call frame are cleaned up at the end.
Do not use <a class="reference internal" href="language.html#inst-return"><span class="std std-ref">return</span></a> instructions in the code body. Instead call the
leave_func() macro. Use the retvalue() macro to store return values
on the stack.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Label for function</li>
<li><strong>Arg2</strong> – Variable definitions (same format as passed to the vars() macro)</li>
<li><strong>Arg3</strong> – Number of bytes returned on stack (0 for no return values)</li>
<li><strong>Arg4</strong> – Code block for func body</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">func(</span><span class="s">mul</span><span class="p">,</span> <span class="s">`s0</span> <span class="s">is</span> <span class="s">m1</span><span class="p">,</span> <span class="s">s1</span> <span class="s">is</span> <span class="s">m2</span><span class="p">,</span> <span class="s">s2</span> <span class="s">is</span> <span class="s">result&#39;</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="s">`expr(result</span> <span class="o">:=</span> <span class="s">m1</span> <span class="o">*</span> <span class="s">m2</span><span class="nb">)</span>&#39;)
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.getstack">
<code class="descname">getstack</code><span class="sig-paren">(</span><em>Arg1-ArgN</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.getstack" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve multiple contiguous values from the stack without changing the stack pointer.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1-ArgN</strong> – Registers to save values in
The first register corresponds to the highest address</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">getstack(</span><span class="s">s3</span><span class="p">,</span> <span class="s">s4</span><span class="p">,</span> <span class="s">s5</span><span class="nb">)</span> <span class="c">; Get stack offset SP+3, SP+2, and SP+1 into s3, s4, s5</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.getstackat">
<code class="descname">getstackat</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.getstackat" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve values from the stack without changing the stack pointer.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Register to save value in</li>
<li><strong>Arg2</strong> – Offset from stack pointer (offset 1 is the first value) or a register</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">getstackat(</span><span class="s">s3</span><span class="p">,</span> <span class="m">2</span><span class="nb">)</span>  <span class="c">; Get the second value relative to the stack pointer</span>
<span class="nb">getstackat(</span><span class="s">s3</span><span class="p">,</span> <span class="s">s0</span><span class="nb">)</span> <span class="c">; Get stack value pointed at by s0</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.if">
<code class="descname">if</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <span class="optional">[</span><em>Arg3</em>, <span class="optional">]</span><em>Arg4-ArgN</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.if" title="Permalink to this definition">¶</a></dt>
<dd><p>Generic if macro.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Boolean comparison expression.</li>
<li><strong>Arg2</strong> – True clause</li>
<li><strong>Arg3</strong> – Optional else clause or next else-if comparison expression</li>
<li><strong>Arg4-ArgN</strong> – Additional else-if clauses</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The Boolean expression must be of the form: <code class="docutils literal"><span class="pre">reg</span> <span class="pre">op</span> <span class="pre">reg|expression</span></code> where op is &lt;, &gt;, &lt;=, &gt;=, ==, !=, &amp;, or ~&amp;
or of the form <code class="docutils literal"><span class="pre">reg</span></code> which is treated as <code class="docutils literal"><span class="pre">reg</span> <span class="pre">!=</span> <span class="pre">0</span></code>.</p>
<p>Signed comparison is invoked with <code class="docutils literal"><span class="pre">signed(comparison</span> <span class="pre">expr.)</span></code>
With signed comparison the right operand cannot be a named constant.</p>
<p>With the &amp; operator, a <a class="reference internal" href="language.html#inst-test"><span class="std std-ref">test</span></a> instruction is used in place of compare. The true
clause is executed when the result is non-zero (mask matches). The ~&amp; operator executes the
true clause when the test result is zero (no match).</p>
<p>This macro performs a comparison of the left and right operands and then inserts
the if* macro selected by the operation.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">if(</span><span class="s">s0</span> <span class="o">&lt;</span> <span class="s">s1</span><span class="p">,</span> <span class="s">`load</span> <span class="s">s0</span><span class="p">,</span> <span class="m">01</span><span class="s">&#39;</span><span class="p">,</span> <span class="s">`load</span> <span class="s">s0</span><span class="p">,</span> <span class="m">02</span><span class="s">&#39;</span><span class="nb">)</span>
<span class="nb">if(</span><span class="s">s0</span> <span class="o">!=</span> <span class="mh">0xa5</span><span class="p">,</span> <span class="s">`load</span> <span class="s">s0</span><span class="p">,</span> <span class="m">01</span><span class="s">&#39;</span><span class="nb">)</span>
<span class="nb">if(signed(</span><span class="s">s0</span> <span class="o">&lt;</span> <span class="o">-</span><span class="m">10</span><span class="nb">)</span><span class="p">,</span> <span class="s">`load</span> <span class="s">s0</span><span class="p">,</span> <span class="m">01</span><span class="s">&#39;</span><span class="nb">)</span> <span class="c">; Signed comparison with signed()</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.ifeq">
<code class="descname">ifeq</code><span class="sig-paren">(</span><em>Arg1</em><span class="optional">[</span>, <em>Arg2</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.ifeq" title="Permalink to this definition">¶</a></dt>
<dd><p>Low level if-equals</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – True clause</li>
<li><strong>Arg2</strong> – Optional else clause</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>These macros insert labels and <a class="reference internal" href="language.html#inst-jump"><span class="std std-ref">jump</span></a> instructions to implement the behavior of
an if-then or if-then-else statement testing for equality, inequality,
greater-or-equal, or less-than.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="k">compare</span> <span class="n">s0</span><span class="p">,</span> <span class="n">s1</span>
<span class="nb">ifeq(</span><span class="s">`load</span> <span class="s">s3</span><span class="p">,</span> <span class="m">20</span>
      <span class="s">output</span> <span class="s">s3</span><span class="p">,</span> <span class="s">MY_PORT&#39;</span><span class="p">,</span>
<span class="s">;</span> <span class="s">else</span>
     <span class="s">`load</span> <span class="s">s3</span><span class="p">,</span> <span class="m">30</span>
      <span class="s">output</span> <span class="s">s3</span><span class="p">,</span> <span class="s">MY_OTHER_PORT&#39;</span><span class="nb">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.ifge">
<code class="descname">ifge</code><span class="sig-paren">(</span><em>Arg1</em><span class="optional">[</span>, <em>Arg2</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.ifge" title="Permalink to this definition">¶</a></dt>
<dd><p>Low level if-greater-or-equal.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – True clause</li>
<li><strong>Arg2</strong> – Optional else clause</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pb.ifeq" title="ifeq"><code class="xref pb pb-macro docutils literal"><span class="pre">ifeq()</span></code></a> for more information.</p>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.iflt">
<code class="descname">iflt</code><span class="sig-paren">(</span><em>Arg1</em><span class="optional">[</span>, <em>Arg2</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.iflt" title="Permalink to this definition">¶</a></dt>
<dd><p>Low level if-less-than.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – True clause</li>
<li><strong>Arg2</strong> – Optional else clause</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pb.ifeq" title="ifeq"><code class="xref pb pb-macro docutils literal"><span class="pre">ifeq()</span></code></a> for more information.</p>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.ifne">
<code class="descname">ifne</code><span class="sig-paren">(</span><em>Arg1</em><span class="optional">[</span>, <em>Arg2</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.ifne" title="Permalink to this definition">¶</a></dt>
<dd><p>Low level if-not-equal.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – True clause</li>
<li><strong>Arg2</strong> – Optional else clause</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pb.ifeq" title="ifeq"><code class="xref pb pb-macro docutils literal"><span class="pre">ifeq()</span></code></a> for more information.</p>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.input16">
<code class="descname">input16</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em><span class="optional">[</span>, <em>Arg4</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.input16" title="Permalink to this definition">¶</a></dt>
<dd><p>16-bit input.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Arg1</strong> – MSB register of target</li>
<li><strong>Arg2</strong> – LSB register of target</li>
<li><strong>Arg3</strong> – Register pointing to low byte or MSB of source address when Arg4 is present</li>
<li><strong>Arg4</strong> – Optional register for LSB of source address</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Result in Arg1, Arg2</p>
</td>
</tr>
</tbody>
</table>
<p>When three arguments are passed, Arg3 is a register pointing to the low port byte to read from.
It is incremented twice to permit sequential use of input16().
When four arguments are passed, Arg3 and Arg4 are a 16-bit pair of port constants to input from.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="k">constant</span> <span class="n">P_ACCUM_L</span><span class="p">,</span> <span class="mh">1a</span>
<span class="k">constant</span> <span class="n">P_ACCUM_H</span><span class="p">,</span> <span class="mh">1b</span>
<span class="nb">reg16(</span><span class="s">P_ACCUM</span><span class="p">,</span> <span class="s">P_ACCUM_H</span><span class="p">,</span> <span class="s">P_ACCUM_L</span><span class="nb">)</span>
<span class="nb">reg16(</span><span class="s">rx</span><span class="p">,</span> <span class="s">s4</span><span class="p">,</span> <span class="s">s3</span><span class="nb">)</span>
<span class="nb">input16(</span><span class="s">rx</span><span class="p">,</span> <span class="s">P_ACCUM</span><span class="nb">)</span>  <span class="c">; Input direct from address</span>
<span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="n">P_ACCUM_L</span>
<span class="nb">input16(</span><span class="s">rx</span><span class="p">,</span> <span class="s">s0</span><span class="nb">)</span>       <span class="c">; Input from indirect pointer</span>
<span class="nb">input16(</span><span class="s">rx</span><span class="p">,</span> <span class="s">s0</span><span class="nb">)</span>       <span class="c">; Input next word</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.instdata">
<code class="descname">instdata</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.instdata" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate an INST directive from a pair of decimal values.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – High 10-bits</li>
<li><strong>Arg2</strong> – Low byte</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">instdata(pbhex(</span><span class="mh">0A</span><span class="p">,</span> <span class="mh">0B</span><span class="nb">))</span>  <span class="c">; Expands to inst 00A0B</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.insttable_be">
<code class="descname">insttable_be</code><span class="sig-paren">(</span><em>Arg1-ArgN</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.insttable_be" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a list of data into a series of INST directives in big-endian byte order.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1-ArgN</strong> – Data to convert in decimal format</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">insttable_be(pbhex(</span><span class="mh">0a</span><span class="p">,</span> <span class="mh">0b</span><span class="p">,</span> <span class="mh">0c</span><span class="nb">))</span>
<span class="k">Expands</span> <span class="n">to</span>:  inst 00a0b
             <span class="k">inst</span> <span class="mh">00c00</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.insttable_le">
<code class="descname">insttable_le</code><span class="sig-paren">(</span><em>Arg1-ArgN</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.insttable_le" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a list of data into a series of INST directives in little-endian byte order.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1-ArgN</strong> – Data to convert in decimal format</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">insttable_le(pbhex(</span><span class="mh">0a</span><span class="p">,</span> <span class="mh">0b</span><span class="p">,</span> <span class="mh">0c</span><span class="nb">))</span>
<span class="k">Expands</span> <span class="n">to</span>:  inst 00b0a
             <span class="k">inst</span> <span class="mh">0000c</span>

<span class="nb">insttable_le(asciiord(</span><span class="s">`Pack</span> <span class="s">strings</span> <span class="s">into</span> <span class="s">ROM&#39;</span><span class="nb">))</span>

  <span class="k">inst</span> <span class="mh">06150</span>
  <span class="k">inst</span> <span class="mh">06b63</span>
  <span class="k">inst</span> <span class="mh">07320</span>
  ...
  <span class="k">inst</span> <span class="mh">0206f</span>
  <span class="k">inst</span> <span class="mh">04f52</span>
  <span class="k">inst</span> <span class="mh">0004d</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.iodefs">
<code class="descname">iodefs</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2-ArgN</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.iodefs" title="Permalink to this definition">¶</a></dt>
<dd><p>Define a series of contiguous port or scratchpad memory constants.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Starting address for port or memory</li>
<li><strong>Arg2-ArgN</strong> – Constant names</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">iodefs(</span><span class="m">0</span><span class="p">,</span> <span class="s">P_uart_out</span><span class="p">,</span> <span class="s">P_uart_in</span><span class="p">,</span> <span class="s">P_control</span><span class="nb">)</span>

<span class="k">Expands</span> <span class="n">to</span>:
  <span class="k">constant</span> <span class="n">P_uart_out</span><span class="p">,</span> <span class="mh">00</span>
  <span class="k">constant</span> <span class="n">P_uart_in</span><span class="p">,</span> <span class="mh">01</span>
  <span class="k">constant</span> <span class="n">P_control</span><span class="p">,</span> <span class="mh">02</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.isnum">
<code class="descname">isnum</code><span class="sig-paren">(</span><em>Arg1</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.isnum" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine if argument is a number in m4 syntax.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">There must be no leading or trailing whitespace.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Arg1</strong> – String to check</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">1 for true 0 for false</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">isnum(</span><span class="s">foo</span><span class="nb">)</span>  <span class="c">; Expands to 0</span>
<span class="nb">isnum(</span><span class="mh">0x42</span><span class="nb">)</span> <span class="c">; Expands to 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.isr">
<code class="descname">isr</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <span class="optional">[</span><em>Arg3</em>, <span class="optional">]</span><em>Arg4</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.isr" title="Permalink to this definition">¶</a></dt>
<dd><p>ISR definition.</p>
<p>This creates an ISR that takes care of saving registers on the stack.
Do not use <a class="reference internal" href="language.html#inst-returni"><span class="std std-ref">returni</span></a> instructions in the code body. Instead call the
leave_func() macro.
By default the ISR returns with interrupts enabled. You can leave them
disabled by passing “disable” as Arg3.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Address for ISR</li>
<li><strong>Arg2</strong> – Variable definitions (same format as passed to the vars() macro)</li>
<li><strong>Arg3</strong> – Optional return interrupt state “enable” | “disable” | empty</li>
<li><strong>Arg4</strong> – Code block for ISR body</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">isr(</span><span class="mh">0x3FF</span><span class="p">,</span> <span class="s">`s0</span><span class="p">,</span> <span class="s">s1</span><span class="p">,</span> <span class="s">s2&#39;</span><span class="p">,</span> <span class="s">`load</span> <span class="s">s0</span><span class="p">,</span> <span class="m">42</span>
                          <span class="s">output</span> <span class="s">s0</span><span class="p">,</span> <span class="s">ff&#39;</span><span class="nb">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.jeq">
<code class="descname">jeq</code><span class="sig-paren">(</span><em>Arg1</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.jeq" title="Permalink to this definition">¶</a></dt>
<dd><p>Jump if equal.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Label to jump to</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="k">compare</span> <span class="n">s0</span><span class="p">,</span> <span class="n">s1</span>
<span class="nb">jeq(</span><span class="s">is_equal</span><span class="nb">)</span>   <span class="c">; jumps if s0 == s1</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.jge">
<code class="descname">jge</code><span class="sig-paren">(</span><em>Arg1</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.jge" title="Permalink to this definition">¶</a></dt>
<dd><p>Jump if greater or equal.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Label to jump to</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="macro">
<dt id="pb.jlt">
<code class="descname">jlt</code><span class="sig-paren">(</span><em>Arg1</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.jlt" title="Permalink to this definition">¶</a></dt>
<dd><p>Jump if less than.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Label to jump to</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="k">compare</span> <span class="n">s0</span><span class="p">,</span> <span class="n">s1</span>
<span class="nb">jlt(</span><span class="s">less_than</span><span class="nb">)</span>  <span class="c">; jumps if s0 &lt; s1</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.jne">
<code class="descname">jne</code><span class="sig-paren">(</span><em>Arg1</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.jne" title="Permalink to this definition">¶</a></dt>
<dd><p>Jump if not equal.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Label to jump to</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="macro">
<dt id="pb.leave_func">
<code class="descname">leave_func</code><span class="sig-paren">(</span><span class="optional">[</span><em>Arg1</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.leave_func" title="Permalink to this definition">¶</a></dt>
<dd><p>Return from func() macro code bodies.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Optional condition code (Z, NZ, C, or NC)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="k">leave_func</span>
<span class="nb">leave_func(</span><span class="s">Z</span><span class="nb">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.leave_isr">
<code class="descname">leave_isr</code><span class="sig-paren">(</span><span class="optional">[</span><em>Arg1</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.leave_isr" title="Permalink to this definition">¶</a></dt>
<dd><p>Return from isr() macro code bodies.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Optional condition code (Z, NZ, C, or NC)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">leave_isr(</span><span class="s">Z</span><span class="nb">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.load16">
<code class="descname">load16</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em><span class="optional">[</span>, <em>Arg4</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.load16" title="Permalink to this definition">¶</a></dt>
<dd><p>16-bit load.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Arg1</strong> – MSB destination register</li>
<li><strong>Arg2</strong> – LSB destination register</li>
<li><strong>Arg3</strong> – Decimal constant or expression or source MSB when Arg4 is present</li>
<li><strong>Arg4</strong> – Optional register for source LSB</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Result in Arg1, Arg2</p>
</td>
</tr>
</tbody>
</table>
<p>When three arguments are passed, Arg3 is a constant literal. When four arguments are passed,
Arg3 and Arg4 are a 16-bit register pair copied to the destination.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">load16(</span><span class="s">s1</span><span class="p">,</span> <span class="s">s0</span><span class="p">,</span> <span class="m">2014</span><span class="nb">)</span>         <span class="c">; Load 16-bit literal</span>
<span class="nb">load16(</span><span class="s">s1</span><span class="p">,</span> <span class="s">s0</span><span class="p">,</span> <span class="m">200</span> <span class="o">*</span> <span class="m">11</span> <span class="o">+</span> <span class="m">5</span><span class="nb">)</span> <span class="c">; Load 16-bit constant expresson</span>
<span class="nb">load16(</span><span class="s">s1</span><span class="p">,</span> <span class="s">s0</span><span class="p">,</span> <span class="s">s3</span><span class="p">,</span> <span class="s">s2</span><span class="nb">)</span>       <span class="c">; Load 16-bits from a register pair</span>
<span class="nb">load16(</span><span class="s">rx</span><span class="p">,</span> <span class="s">ry</span><span class="nb">)</span>               <span class="c">; Assuming rx and ry are reg16 definitions</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.load_out">
<code class="descname">load_out</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em><span class="optional">[</span>, <em>Arg3</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.load_out" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a register with a value and output to a port.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Value to load (constant or other register)</li>
<li><strong>Arg2</strong> – Port to output to</li>
<li><strong>Arg3</strong> – Optional register to load with value, uses _tempreg if omitted</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">load_out(</span><span class="mh">0x5A</span><span class="p">,</span> <span class="mh">0x10</span><span class="nb">)</span>     <span class="c">; Write 0x5A to port 0x10 using _tempreg</span>
<span class="nb">load_out(</span><span class="mh">0x5A</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="s">sA</span><span class="nb">)</span> <span class="c">; Write 0x5A to port 0x10 using sA</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.load_store">
<code class="descname">load_store</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em><span class="optional">[</span>, <em>Arg3</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.load_store" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a register with a value and store to scratchpad.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Value to load (constant or other register)</li>
<li><strong>Arg2</strong> – Scratchpad address to output to (constant or a register)</li>
<li><strong>Arg3</strong> – Optional Register to load with value, uses _tempreg if omitted</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">load_store(</span><span class="mh">0x42</span><span class="p">,</span> <span class="mh">0x20</span><span class="nb">)</span>     <span class="c">; Store 0x42 at scratchpad address 0x20 using _tempreg</span>
<span class="nb">load_store(</span><span class="mh">0x42</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">,</span> <span class="s">sA</span><span class="nb">)</span> <span class="c">; Store 0x42 at scratchpad address 0x20 using sA</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.loadaddr">
<code class="descname">loadaddr</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.loadaddr" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a 16-bit address from a label.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Arg1</strong> – MSB destination register</li>
<li><strong>Arg2</strong> – LSB destination register</li>
<li><strong>Arg3</strong> – Address label</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Result in Arg1, Arg2</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nl">my_func:</span> <span class="k">return</span>
<span class="nb">loadaddr(</span><span class="s">s1</span><span class="p">,</span><span class="s">s0</span><span class="p">,</span> <span class="s">my_func</span><span class="nb">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.mask">
<code class="descname">mask</code><span class="sig-paren">(</span><em>Arg1-ArgN</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Define a mask with specific bits set.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1-ArgN</strong> – Bit numbers to set in mask (0-7)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">mask(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">7</span><span class="nb">)</span>     <span class="c">; Expands to 135 = 0x87</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.maskh">
<code class="descname">maskh</code><span class="sig-paren">(</span><em>Arg1</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.maskh" title="Permalink to this definition">¶</a></dt>
<dd><p>Alternate mask that can be used as a direct argument to a PicoBlaze instruction.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Arg1</strong> – Bit numbers to set in mask (0-7)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A mask in PicoBlaze hex format</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="k">test</span> <span class="n">s0</span><span class="p">,</span> <span class="nb">maskh(</span><span class="m">3</span><span class="p">,</span><span class="m">4</span><span class="p">,</span><span class="m">5</span><span class="nb">)</span> <span class="c">; Test if bits 3, 4, and 5 are clear</span>
<span class="k">jump</span> <span class="n">z</span><span class="p">,</span> <span class="n">is_clear</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.mem16">
<code class="descname">mem16</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.mem16" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a constant for 16-bit memory and port addresses.
This is similar to <a class="reference internal" href="#pb.reg16" title="reg16"><code class="xref pb pb-macro docutils literal"><span class="pre">reg16()</span></code></a> but it also generates
named constants with “_H” and “_L” suffixes for
byte access.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Name of constant</li>
<li><strong>Arg2</strong> – MSB address</li>
<li><strong>Arg3</strong> – LSB address</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">mem16(</span><span class="s">M_DATA</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0x04</span><span class="nb">)</span> <span class="c">; Allocate scratchpad 05, 04 for use as M_DATA</span>
<span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="n">M_DATA_L</span>  <span class="c">; load address 0x04</span>
<span class="k">load</span> <span class="n">s1</span><span class="p">,</span> <span class="n">M_DATA_H</span>  <span class="c">; load address 0x05</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.negate">
<code class="descname">negate</code><span class="sig-paren">(</span><em>Arg1</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.negate" title="Permalink to this definition">¶</a></dt>
<dd><p>2s complement negation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Arg1</strong> – Register to negate</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Result is in the same register</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="m">10&#39;d</span>
<span class="nb">negate(</span><span class="s">s0</span><span class="nb">)</span>     <span class="c">; Result is -10</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.negate16">
<code class="descname">negate16</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.negate16" title="Permalink to this definition">¶</a></dt>
<dd><p>16-bit 2s-complement negation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – MSB register to negate</li>
<li><strong>Arg2</strong> – LSB register to negate</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Result in Arg1, Arg2</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">load16(</span><span class="s">s1</span><span class="p">,</span><span class="s">s0</span><span class="p">,</span> <span class="o">-</span><span class="m">2600</span><span class="nb">)</span>
<span class="nb">negate16(</span><span class="s">s1</span><span class="p">,</span> <span class="s">s0</span><span class="nb">)</span>     <span class="c">; s1,s0 pair now contain +2600</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.nop">
<code class="descname">nop</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.nop" title="Permalink to this definition">¶</a></dt>
<dd><p>No-op macro.
Delay by one instruction without affecting processor state.</p>
</dd></dl>

<dl class="macro">
<dt id="pb.not">
<code class="descname">not</code><span class="sig-paren">(</span><em>Arg1</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.not" title="Permalink to this definition">¶</a></dt>
<dd><p>Logical not.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Arg1</strong> – Register to invert</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Result is in the same register</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="mh">5A</span>
<span class="nb">not(</span><span class="s">s0</span><span class="nb">)</span>     <span class="c">; Result is 0xA5</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.not16">
<code class="descname">not16</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.not16" title="Permalink to this definition">¶</a></dt>
<dd><p>16-bit logical not.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – MSB register to invert</li>
<li><strong>Arg2</strong> – LSB register to invert</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Result in Arg1, Arg2</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">load16(</span><span class="s">s1</span><span class="p">,</span><span class="s">s0</span><span class="p">,</span> <span class="mh">0x8F5A</span><span class="nb">)</span>
<span class="nb">not16(</span><span class="s">s1</span><span class="p">,</span> <span class="s">s0</span><span class="nb">)</span> <span class="c">; s1,s0 pair now contain 0x70A5</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.or16">
<code class="descname">or16</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em><span class="optional">[</span>, <em>Arg4</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.or16" title="Permalink to this definition">¶</a></dt>
<dd><p>16-bit logical OR.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Arg1</strong> – MSB1</li>
<li><strong>Arg2</strong> – LSB1</li>
<li><strong>Arg3</strong> – Decimal constant or expression or MSB2 when Arg4 is present</li>
<li><strong>Arg4</strong> – Optional register for LSB2</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Result in Arg1, Arg2</p>
</td>
</tr>
</tbody>
</table>
<p>When three arguments are passed, Arg3 is a constant literal. When four arguments are passed,
Arg3 and Arg4 are a 16-bit pair to OR to the result.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">load16(</span><span class="s">s1</span><span class="p">,</span><span class="s">s0</span><span class="p">,</span> <span class="mh">0x10F0</span><span class="nb">)</span>
<span class="nb">or16(</span><span class="s">s1</span><span class="p">,</span><span class="s">s0</span><span class="p">,</span> <span class="mh">0x008F</span><span class="nb">)</span>   <span class="c">; Result is 0x10FF</span>
<span class="nb">or16(</span><span class="s">s1</span><span class="p">,</span><span class="s">s0</span><span class="p">,</span> <span class="s">s3</span><span class="p">,</span><span class="s">s2</span><span class="nb">)</span>    <span class="c">; (s1,s0) OR (s3,s2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.output16">
<code class="descname">output16</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em><span class="optional">[</span>, <em>Arg4</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.output16" title="Permalink to this definition">¶</a></dt>
<dd><p>16-bit output.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – MSB register of source</li>
<li><strong>Arg2</strong> – LSB register of source</li>
<li><strong>Arg3</strong> – Register pointing to low byte or MSB of output address when Arg4 is present</li>
<li><strong>Arg4</strong> – Optional register for LSB of output address</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>When three arguments are passed, Arg3 is a register pointing to the low byte to output to.
It is incremented twice to permit sequential use of output16().
When four arguments are passed, Arg3 and Arg4 are a 16-bit pair of port address constants to output to.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">load16(</span><span class="s">rx</span><span class="p">,</span> <span class="m">2014</span><span class="nb">)</span>
<span class="nb">output16(</span><span class="s">rx</span><span class="p">,</span> <span class="s">P_ACCUM</span><span class="nb">)</span>  <span class="c">; Output direct to port address</span>
<span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="n">P_ACCUM_L</span>
<span class="nb">output16(</span><span class="s">rx</span><span class="p">,</span> <span class="s">s0</span><span class="nb">)</span>       <span class="c">; Output to indirect pointer</span>
<span class="nb">output16(</span><span class="s">rx</span><span class="p">,</span> <span class="s">s0</span><span class="nb">)</span>       <span class="c">; Output next word</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.outputstring">
<code class="descname">outputstring</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.outputstring" title="Permalink to this definition">¶</a></dt>
<dd><p>Repeated string output operation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Output port in m4 integer format or a constant name</li>
<li><strong>Arg2</strong> – Register used to hold characters</li>
<li><strong>Arg3</strong> – String to split into characters</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="k">constant</span> <span class="n">UART_PORT</span><span class="p">,</span> <span class="mh">0a</span>
<span class="nb">outputstring(</span><span class="s">UART_PORT</span><span class="p">,</span> <span class="s">s1</span><span class="p">,</span> <span class="s">`My</span> <span class="s">string&#39;</span><span class="nb">)</span>
<span class="k">Expands</span> <span class="n">to</span>:
   <span class="k">load</span> <span class="n">s1</span><span class="p">,</span> <span class="sc">&quot;M&quot;</span>
   <span class="k">output</span> <span class="n">s1</span><span class="p">,</span> <span class="n">UART_PORT</span>
   <span class="k">load</span> <span class="n">s1</span><span class="p">,</span> <span class="sc">&quot;y&quot;</span>
   <span class="k">output</span> <span class="n">s1</span><span class="p">,</span> <span class="n">UART_PORT</span>
   ...

<span class="nb">outputstring(</span><span class="mh">0x0A</span><span class="p">,</span> <span class="s">s1</span><span class="p">,</span> <span class="s">`My</span> <span class="s">string&#39;</span><span class="nb">)</span> <span class="c">; Without using a constant</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.outputtable">
<code class="descname">outputtable</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3-ArgN</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.outputtable" title="Permalink to this definition">¶</a></dt>
<dd><p>Output a table of constants.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Output port in m4 integer format or a constant name</li>
<li><strong>Arg2</strong> – Temporary register for each constant</li>
<li><strong>Arg3-ArgN</strong> – Decimal values to output to port</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="k">constant</span> <span class="n">UART_PORT</span><span class="p">,</span> <span class="mh">0a</span>
<span class="nb">outputtable(</span><span class="s">UART_PORT</span><span class="p">,</span> <span class="s">sF</span><span class="p">,</span> <span class="nb">pbhex(</span><span class="mh">DE</span><span class="p">,</span><span class="mh">AD</span><span class="p">,</span><span class="mh">BE</span><span class="p">,</span><span class="mh">EF</span><span class="nb">))</span> <span class="c">; Output DE,AD,BE,EF to port</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.pb2m4">
<code class="descname">pb2m4</code><span class="sig-paren">(</span><em>Arg1</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.pb2m4" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert PicoBlaze literals into m4 syntax. Performs the following conversions:</p>
<ul class="simple">
<li>Character literal to ASCII ordinal: <code class="docutils literal"><span class="pre">&quot;c&quot;</span> <span class="pre">-&gt;</span> <span class="pre">99</span></code></li>
<li>Decimal to integer: <code class="docutils literal"><span class="pre">20'd</span> <span class="pre">-&gt;</span> <span class="pre">20</span></code></li>
<li>Hex to integer: <code class="docutils literal"><span class="pre">5A</span> <span class="pre">-&gt;</span> <span class="pre">90</span></code></li>
<li>Binary to integer: <code class="docutils literal"><span class="pre">1100'b</span> <span class="pre">-&gt;</span> <span class="pre">12</span></code></li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Arg1</strong> – String to convert</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">An integer in m4 syntax.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">pb2m4(</span><span class="m">10</span><span class="s">&#39;d</span><span class="nb">)</span> <span class="k">expands</span> <span class="n">to</span> <span class="mh">10</span><span class="p">,</span>  <span class="nb">pb2m4(</span><span class="s">&quot;0&quot;</span><span class="nb">)</span> <span class="n">expands</span> <span class="n">to</span> <span class="mh">48</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.pbhex">
<code class="descname">pbhex</code><span class="sig-paren">(</span><em>Arg1-ArgN</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.pbhex" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a list of values in PicoBlaze hex format to decimal.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1-ArgN</strong> – Hex values to convert</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">pbhex(</span><span class="mh">01</span><span class="p">,</span> <span class="mh">02</span><span class="p">,</span> <span class="mh">03</span><span class="p">,</span> <span class="mh">0a</span><span class="p">,</span> <span class="mh">ff</span><span class="nb">)</span>  <span class="c">; Expands to 1, 2, 3, 10, 255</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.pop">
<code class="descname">pop</code><span class="sig-paren">(</span><em>Arg1-ArgN</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.pop" title="Permalink to this definition">¶</a></dt>
<dd><p>Pop register values from a simulated stack in scratchpad RAM.</p>
<p>Arguments should be passed in the same order as push() to restore register contents.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1-ArgN</strong> – Registers with values to pop</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pb.push" title="push"><code class="xref pb pb-macro docutils literal"><span class="pre">push()</span></code></a> for more information.</p>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.popvars">
<code class="descname">popvars</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.popvars" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove definitions from previous call to vars().</p>
</dd></dl>

<dl class="macro">
<dt id="pb.proc">
<code class="descname">proc</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.proc" title="Permalink to this definition">¶</a></dt>
<dd><p>Procedure definition.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Label for procedure</li>
<li><strong>Arg2</strong> – Variable definitions (same format as passed to the vars() macro)</li>
<li><strong>Arg3</strong> – Code block for proc body</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">proc(</span><span class="s">add2</span><span class="p">,</span> <span class="s">`s0</span> <span class="s">is</span> <span class="s">result&#39;</span><span class="p">,</span> <span class="s">`add</span> <span class="s">result</span><span class="p">,</span> <span class="m">02</span><span class="s">&#39;</span><span class="nb">)</span>
...
<span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="mh">42</span>
<span class="k">call</span> <span class="mh">add2</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.push">
<code class="descname">push</code><span class="sig-paren">(</span><em>Arg1-ArgN</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.push" title="Permalink to this definition">¶</a></dt>
<dd><p>Push register values onto a simulated stack in scratchpad RAM.</p>
<p>The stack pointer grows from the end of the scratchpad to the start.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1-ArgN</strong> – Registers with values to push</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">use_stack(</span><span class="s">sa</span><span class="p">,</span> <span class="mh">0x3F</span><span class="nb">)</span>
<span class="nb">push(</span><span class="s">s0</span><span class="nb">)</span>
<span class="nb">pop(</span><span class="s">s1</span><span class="nb">)</span>
<span class="nb">push(</span><span class="s">s3</span><span class="p">,</span> <span class="s">s4</span><span class="p">,</span> <span class="s">s5</span><span class="nb">)</span>  <span class="c">; Push and pop multiple registers at once</span>
<span class="nb">pop(</span><span class="s">s3</span><span class="p">,</span> <span class="s">s4</span><span class="p">,</span> <span class="s">s5</span><span class="nb">)</span>   <span class="c">; Pop is performed in reverse order from push</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.putstack">
<code class="descname">putstack</code><span class="sig-paren">(</span><em>Arg1-ArgN</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.putstack" title="Permalink to this definition">¶</a></dt>
<dd><p>Store multiple contiguous values on the stack without changing the stack pointer.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1-ArgN</strong> – Registers to store values from
The first register corresponds to the highest address</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">putstack(</span><span class="s">s3</span><span class="p">,</span> <span class="s">s4</span><span class="p">,</span> <span class="s">s5</span><span class="nb">)</span> <span class="c">; Put s3, s4, s5 into stack offset SP+3, SP+2, and SP+1</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.putstackat">
<code class="descname">putstackat</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.putstackat" title="Permalink to this definition">¶</a></dt>
<dd><p>Store values to the stack without changing the stack pointer.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Register with value to store</li>
<li><strong>Arg2</strong> – Offset from stack pointer (offset 1 is the first value) or a register</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">putstackat(</span><span class="s">s3</span><span class="p">,</span> <span class="m">2</span><span class="nb">)</span>  <span class="c">; Put the second value relative to the stack pointer</span>
<span class="nb">putstackat(</span><span class="s">s3</span><span class="p">,</span> <span class="s">s0</span><span class="nb">)</span> <span class="c">; Put stack value pointed at by s0</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.qstr">
<code class="descname">qstr</code><span class="sig-paren">(</span><em>Arg1</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.qstr" title="Permalink to this definition">¶</a></dt>
<dd><p>Add double quotes around a string.
This is allows the use of macros to generate strings where substitution within “” would
normally be suppressed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – String to quote</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">define(</span><span class="s">DATE_STAMP</span><span class="p">,</span> <span class="s">`1</span> <span class="s">Jan</span> <span class="m">2015</span><span class="s">&#39;</span><span class="nb">)</span>
<span class="k">string</span> <span class="n">mystr$</span><span class="p">,</span> <span class="nb">qstr(</span><span class="s">DATE_STAMP</span><span class="nb">)</span>  <span class="c">; Expands to string mystr$, &quot;1 Jan 2015&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.randlabel">
<code class="descname">randlabel</code><span class="sig-paren">(</span><span class="optional">[</span><em>Arg1</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.randlabel" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a random name for a label.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Optional prefix to name</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">randlabel(</span><span class="s">PREFIX_</span><span class="nb">)</span> <span class="c">; Expands to &quot;__PREFIX_?????&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.reg16">
<code class="descname">reg16</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.reg16" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a virtual 16-bit register.
The defined name can be used in place of the MSB, LSB pairs used in other 16-bit macros.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Name of virtual register</li>
<li><strong>Arg2</strong> – MSB register</li>
<li><strong>Arg3</strong> – LSB register</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">reg16(</span><span class="s">rx</span><span class="p">,</span> <span class="s">s1</span><span class="p">,</span> <span class="s">s0</span><span class="nb">)</span> <span class="c">; rx = (s1, s0)</span>
<span class="nb">reg16(</span><span class="s">ry</span><span class="p">,</span> <span class="s">s5</span><span class="p">,</span> <span class="s">s4</span><span class="nb">)</span> <span class="c">; ry = (s5, s4)</span>
<span class="nb">add16(</span><span class="s">rx</span><span class="p">,</span> <span class="s">ry</span><span class="nb">)</span>     <span class="c">; rx = rx + ry</span>
<span class="nb">add16(</span><span class="s">rx</span><span class="p">,</span> <span class="s">s3</span><span class="p">,</span> <span class="s">s2</span><span class="nb">)</span> <span class="c">; rx = rx + (s3, s2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.reglower">
<code class="descname">reglower</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.reglower" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the lower register from a <a class="reference internal" href="#pb.reg16" title="reg16"><code class="xref pb pb-macro docutils literal"><span class="pre">reg16()</span></code></a> or <a class="reference internal" href="#pb.mem16" title="mem16"><code class="xref pb pb-macro docutils literal"><span class="pre">mem16()</span></code></a> definition.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – MSB of 16-bit register pair</li>
<li><strong>Arg2</strong> – LSB of 16-bit register pair</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pb.regupper" title="regupper"><code class="xref pb pb-macro docutils literal"><span class="pre">regupper()</span></code></a> for more information.</p>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.regupper">
<code class="descname">regupper</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.regupper" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the upper register from a <a class="reference internal" href="#pb.reg16" title="reg16"><code class="xref pb pb-macro docutils literal"><span class="pre">reg16()</span></code></a> or <a class="reference internal" href="#pb.mem16" title="mem16"><code class="xref pb pb-macro docutils literal"><span class="pre">mem16()</span></code></a> definition.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – MSB of 16-bit register pair</li>
<li><strong>Arg2</strong> – LSB of 16-bit register pair</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">reg16(</span><span class="s">rx</span><span class="p">,</span> <span class="s">s5</span><span class="p">,</span> <span class="s">s4</span><span class="nb">)</span>
<span class="k">load</span> <span class="n">s1</span><span class="p">,</span> <span class="nb">regupper(</span><span class="s">rx</span><span class="nb">)</span> <span class="c">; load upper byte from s5 (rx expands to &quot;s5,s4&quot;)</span>
<span class="k">load</span> <span class="n">s1</span><span class="p">,</span> <span class="nb">reglower(</span><span class="s">rx</span><span class="nb">)</span> <span class="c">; load lower byte from s4</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.repeat">
<code class="descname">repeat</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.repeat" title="Permalink to this definition">¶</a></dt>
<dd><p>Repeat an instruction or macro.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Instruction or macro string to repeat</li>
<li><strong>Arg2</strong> – Numper of repetitions</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">repeat(</span><span class="s">`output</span> <span class="s">s0</span><span class="p">,</span> <span class="m">00</span><span class="s">&#39;</span><span class="p">,</span> <span class="m">3</span><span class="nb">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.repeatstr">
<code class="descname">repeatstr</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.repeatstr" title="Permalink to this definition">¶</a></dt>
<dd><p>Repeat a string.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Instruction or macro string to repeat</li>
<li><strong>Arg2</strong> – Numper of repetitions</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">repeat(</span><span class="s">`A&#39;</span><span class="p">,</span> <span class="m">3</span><span class="nb">)</span> <span class="c">; Expands to &quot;AAA&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.reteq">
<code class="descname">reteq</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.reteq" title="Permalink to this definition">¶</a></dt>
<dd><p>Return if equal.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="k">compare</span> <span class="n">s0</span><span class="p">,</span> <span class="n">s1</span>
<span class="k">reteq</span>   <span class="c">; return if s0 == s1</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.retge">
<code class="descname">retge</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.retge" title="Permalink to this definition">¶</a></dt>
<dd><p>Return if greater or equal.</p>
</dd></dl>

<dl class="macro">
<dt id="pb.retlt">
<code class="descname">retlt</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.retlt" title="Permalink to this definition">¶</a></dt>
<dd><p>Return if less than.</p>
</dd></dl>

<dl class="macro">
<dt id="pb.retne">
<code class="descname">retne</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.retne" title="Permalink to this definition">¶</a></dt>
<dd><p>Return if not equal.</p>
</dd></dl>

<dl class="macro">
<dt id="pb.retvalue">
<code class="descname">retvalue</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.retvalue" title="Permalink to this definition">¶</a></dt>
<dd><p>Place func return value onto the stack.</p>
<p>Only call this macro inside a func code body</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Register with value to save</li>
<li><strong>Arg2</strong> – Offset from end of return frame (starting at 1)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">retvalue(</span><span class="s">s0</span><span class="p">,</span> <span class="m">1</span><span class="nb">)</span> <span class="c">; First return value to be popped off after return</span>
<span class="nb">retvalue(</span><span class="s">s1</span><span class="p">,</span> <span class="m">2</span><span class="nb">)</span> <span class="c">; Second value to return from func</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.reverse">
<code class="descname">reverse</code><span class="sig-paren">(</span><em>Arg1-ArgN</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.reverse" title="Permalink to this definition">¶</a></dt>
<dd><p>Reverse arguments.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1-ArgN</strong> – List of arguments to reverse</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">reverse(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="nb">)</span> <span class="c">; Expands to 3,2,1</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.rl">
<code class="descname">rl</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.rl" title="Permalink to this definition">¶</a></dt>
<dd><p>Multi-bit rotate left.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Register to rotate</li>
<li><strong>Arg2</strong> – Number of shifts</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">rl(</span><span class="s">s2</span><span class="p">,</span> <span class="m">4</span><span class="nb">)</span>  <span class="c">; Rotate left by 4</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.rl16">
<code class="descname">rl16</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.rl16" title="Permalink to this definition">¶</a></dt>
<dd><p>16-bit rotate left.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – MSB register to rotate</li>
<li><strong>Arg2</strong> – LSB register to rotate</li>
<li><strong>Arg3</strong> – Number of bits to rotate (0-16)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="macro">
<dt id="pb.rr">
<code class="descname">rr</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.rr" title="Permalink to this definition">¶</a></dt>
<dd><p>Multi-bit rotate right.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Register to rotate</li>
<li><strong>Arg2</strong> – Number of shifts</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">rr(</span><span class="s">s2</span><span class="p">,</span> <span class="m">4</span><span class="nb">)</span>  <span class="c">; Rotate right by 4</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.rr16">
<code class="descname">rr16</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.rr16" title="Permalink to this definition">¶</a></dt>
<dd><p>16-bit rotate right.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – MSB register to rotate</li>
<li><strong>Arg2</strong> – LSB register to rotate</li>
<li><strong>Arg3</strong> – Number of bits to rotate (0-16)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="macro">
<dt id="pb.setbit">
<code class="descname">setbit</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.setbit" title="Permalink to this definition">¶</a></dt>
<dd><p>Set and clear bits in a register.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Register to modify</li>
<li><strong>Arg2</strong> – Bit number (0-7) to set or clear</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">setbit(</span><span class="s">s0</span><span class="p">,</span> <span class="m">2</span><span class="nb">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.setcy">
<code class="descname">setcy</code><span class="sig-paren">(</span><span class="optional">[</span><em>Arg1</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.setcy" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the carry flag.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Optional temporary register to modify. Uses temp register by default.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="k">setcy</span>
<span class="nb">setcy(</span><span class="s">sF</span><span class="nb">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.setmask">
<code class="descname">setmask</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.setmask" title="Permalink to this definition">¶</a></dt>
<dd><p>Set mask bits in a register.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Register to modify</li>
<li><strong>Arg2</strong> – Mask value</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">setmask(</span><span class="s">s5</span><span class="p">,</span> <span class="nb">mask(</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="nb">))</span>
<span class="nb">setmask(</span><span class="s">s4</span><span class="p">,</span> <span class="mh">0xF1</span><span class="nb">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.signed">
<code class="descname">signed</code><span class="sig-paren">(</span><em>Arg1</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.signed" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a Boolean expression to use signed comparison.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Expression to convert</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>This is used in the expression passed to the if(), for(), while(), and dowhile()
macros to invoke signed comparison.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">signed(</span><span class="s">s0</span> <span class="o">&lt;</span> <span class="m">4</span><span class="nb">)</span>  <span class="c">; Expands to &quot;s0 s&lt; 4&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.signex">
<code class="descname">signex</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.signex" title="Permalink to this definition">¶</a></dt>
<dd><p>Sign extension.</p>
<p>This extends the sign from an 8-bit number into a new register producing a 16-bit result.
The argument order allows you to use this with virtual registers created with <a class="reference internal" href="#pb.reg16" title="reg16"><code class="xref pb pb-macro docutils literal"><span class="pre">reg16()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Register to extend sign into (MSB)</li>
<li><strong>Arg2</strong> – Register to test for sign bit (LSB)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="mh">81</span>     <span class="c">; Sign bit is set</span>
<span class="nb">signex(</span><span class="s">s1</span><span class="p">,</span> <span class="s">s0</span><span class="nb">)</span>  <span class="c">; s1 now contains 0xFF</span>

<span class="nb">reg16(</span><span class="s">rx</span><span class="p">,</span> <span class="s">s4</span><span class="p">,</span><span class="s">s5</span><span class="nb">)</span>
<span class="k">load</span> <span class="nb">reglower(</span><span class="s">rx</span><span class="nb">)</span><span class="p">,</span> <span class="mh">82</span>
<span class="nb">signex(</span><span class="s">rx</span><span class="nb">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.sl0">
<code class="descname">sl0</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.sl0" title="Permalink to this definition">¶</a></dt>
<dd><p>Multi-bit shift left with ‘0’ insert.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Register to shift</li>
<li><strong>Arg2</strong> – Number of shifts</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">sl0(</span><span class="s">s2</span><span class="p">,</span> <span class="m">4</span><span class="nb">)</span>  <span class="c">; Shift left by 4</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.sl0_16">
<code class="descname">sl0_16</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.sl0_16" title="Permalink to this definition">¶</a></dt>
<dd><p>16-bit shift left, inserting ‘0’.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – MSB register to shift</li>
<li><strong>Arg2</strong> – LSB register to shift</li>
<li><strong>Arg3</strong> – Number of bits to shift (0-16)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="macro">
<dt id="pb.sl1">
<code class="descname">sl1</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.sl1" title="Permalink to this definition">¶</a></dt>
<dd><p>Multi-bit shift left with ‘1’ insert.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Register to shift</li>
<li><strong>Arg2</strong> – Number of shifts</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">sl1(</span><span class="s">s2</span><span class="p">,</span> <span class="m">4</span><span class="nb">)</span>  <span class="c">; Shift left by 4</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.sl1_16">
<code class="descname">sl1_16</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.sl1_16" title="Permalink to this definition">¶</a></dt>
<dd><p>16-bit shift left, inserting ‘1’.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – MSB register to shift</li>
<li><strong>Arg2</strong> – LSB register to shift</li>
<li><strong>Arg3</strong> – Number of bits to shift (0-16)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="macro">
<dt id="pb.sla">
<code class="descname">sla</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.sla" title="Permalink to this definition">¶</a></dt>
<dd><p>Multi-bit shift left with C insert.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Register to shift</li>
<li><strong>Arg2</strong> – Number of shifts</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">sla(</span><span class="s">s2</span><span class="p">,</span> <span class="m">4</span><span class="nb">)</span>  <span class="c">; Shift left by 4</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.sla_16">
<code class="descname">sla_16</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.sla_16" title="Permalink to this definition">¶</a></dt>
<dd><p>16-bit arithmetic shift left, inserting C flag.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – MSB register to shift</li>
<li><strong>Arg2</strong> – LSB register to shift</li>
<li><strong>Arg3</strong> – Number of bits to shift (0-16)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="macro">
<dt id="pb.slx">
<code class="descname">slx</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.slx" title="Permalink to this definition">¶</a></dt>
<dd><p>Multi-bit shift left with LSB sign extension.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Register to shift</li>
<li><strong>Arg2</strong> – Number of shifts</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">slx(</span><span class="s">s2</span><span class="p">,</span> <span class="m">4</span><span class="nb">)</span>  <span class="c">; Shift left by 4</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.slx_16">
<code class="descname">slx_16</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.slx_16" title="Permalink to this definition">¶</a></dt>
<dd><p>16-bit sign extending shift left, duplicating LSB.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – MSB register to shift</li>
<li><strong>Arg2</strong> – LSB register to shift</li>
<li><strong>Arg3</strong> – Number of bits to shift (0-16)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="macro">
<dt id="pb.sr0">
<code class="descname">sr0</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.sr0" title="Permalink to this definition">¶</a></dt>
<dd><p>Multi-bit shift right with ‘0’ insert.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Register to shift</li>
<li><strong>Arg2</strong> – Number of shifts</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">sr0(</span><span class="s">s2</span><span class="p">,</span> <span class="m">4</span><span class="nb">)</span>  <span class="c">; Shift right by 4</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.sr0_16">
<code class="descname">sr0_16</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.sr0_16" title="Permalink to this definition">¶</a></dt>
<dd><p>16-bit shift right, inserting ‘0’.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – MSB register to shift</li>
<li><strong>Arg2</strong> – LSB register to shift</li>
<li><strong>Arg3</strong> – Number of bits to shift (0-16)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="macro">
<dt id="pb.sr1">
<code class="descname">sr1</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.sr1" title="Permalink to this definition">¶</a></dt>
<dd><p>Multi-bit shift right with ‘1’ insert.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Register to shift</li>
<li><strong>Arg2</strong> – Number of shifts</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">sr1(</span><span class="s">s2</span><span class="p">,</span> <span class="m">4</span><span class="nb">)</span>  <span class="c">; Shift right by 4</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.sr1_16">
<code class="descname">sr1_16</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.sr1_16" title="Permalink to this definition">¶</a></dt>
<dd><p>16-bit shift right, inserting ‘1’.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – MSB register to shift</li>
<li><strong>Arg2</strong> – LSB register to shift</li>
<li><strong>Arg3</strong> – Number of bits to shift (0-16)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="macro">
<dt id="pb.sra">
<code class="descname">sra</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.sra" title="Permalink to this definition">¶</a></dt>
<dd><p>Multi-bit shift right with C insert.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Register to shift</li>
<li><strong>Arg2</strong> – Number of shifts</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">sra(</span><span class="s">s2</span><span class="p">,</span> <span class="m">4</span><span class="nb">)</span>  <span class="c">; Shift right by 4</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.sra_16">
<code class="descname">sra_16</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.sra_16" title="Permalink to this definition">¶</a></dt>
<dd><p>16-bit arithmetic shift right, inserting C flag.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – MSB register to shift</li>
<li><strong>Arg2</strong> – LSB register to shift</li>
<li><strong>Arg3</strong> – Number of bits to shift (0-16)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="macro">
<dt id="pb.srx">
<code class="descname">srx</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.srx" title="Permalink to this definition">¶</a></dt>
<dd><p>Multi-bit shift right with MSB sign extension.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Register to shift</li>
<li><strong>Arg2</strong> – Number of shifts</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">srx(</span><span class="s">s2</span><span class="p">,</span> <span class="m">4</span><span class="nb">)</span>  <span class="c">; Shift right by 4</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.srx_16">
<code class="descname">srx_16</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.srx_16" title="Permalink to this definition">¶</a></dt>
<dd><p>16-bit sign extending shift right, duplicating MSB.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – MSB register to shift</li>
<li><strong>Arg2</strong> – LSB register to shift</li>
<li><strong>Arg3</strong> – Number of bits to shift (0-16)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="macro">
<dt id="pb.store16">
<code class="descname">store16</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em><span class="optional">[</span>, <em>Arg4</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.store16" title="Permalink to this definition">¶</a></dt>
<dd><p>16-bit store.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – MSB register of source</li>
<li><strong>Arg2</strong> – LSB register of source</li>
<li><strong>Arg3</strong> – Register pointing to low byte or MSB of target address when Arg4 is present</li>
<li><strong>Arg4</strong> – Optional register for LSB of target address</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>When three arguments are passed, Arg3 is a register pointing to the low byte to store to.
It is incremented twice to permit sequential use of store16().
When four arguments are passed, Arg3 and Arg4 are a 16-bit pair of address constants to store to.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">load16(</span><span class="s">rx</span><span class="p">,</span> <span class="m">2014</span><span class="nb">)</span>
<span class="nb">store16(</span><span class="s">rx</span><span class="p">,</span> <span class="s">M_ACCUM</span><span class="nb">)</span>  <span class="c">; Store direct to address</span>
<span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="n">M_ACCUM_L</span>
<span class="nb">store16(</span><span class="s">rx</span><span class="p">,</span> <span class="s">s0</span><span class="nb">)</span>       <span class="c">; Store to indirect pointer</span>
<span class="nb">store16(</span><span class="s">rx</span><span class="p">,</span> <span class="s">s0</span><span class="nb">)</span>       <span class="c">; Store next word</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.storestring">
<code class="descname">storestring</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em><span class="optional">[</span>, <em>Arg3</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.storestring" title="Permalink to this definition">¶</a></dt>
<dd><p>Store a string to scratchpad RAM.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Address of first byte</li>
<li><strong>Arg2</strong> – String to store</li>
<li><strong>Arg3</strong> – Optional register to load each character, uses _tempreg if omitted</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">storestring(</span><span class="mh">0x10</span><span class="p">,</span> <span class="s">`Hello&#39;</span><span class="nb">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.storestringat">
<code class="descname">storestringat</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em><span class="optional">[</span>, <em>Arg3</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.storestringat" title="Permalink to this definition">¶</a></dt>
<dd><p>Store a string to scratchpad RAM using a register address.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Pointer register to scratchpad address</li>
<li><strong>Arg2</strong> – String to store</li>
<li><strong>Arg3</strong> – Optional register to load each character, uses _tempreg if omitted</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The pointer register will finish with the address of the last character in the string.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="n">M_BUFFER</span>
<span class="nb">storestringat(</span><span class="s">s0</span><span class="p">,</span> <span class="s">`Hello&#39;</span><span class="nb">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.storetable">
<code class="descname">storetable</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3-ArgN</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.storetable" title="Permalink to this definition">¶</a></dt>
<dd><p>Store a table of constants in scratchpad RAM.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Address of first byte</li>
<li><strong>Arg2</strong> – Temporary register for each constant</li>
<li><strong>Arg3-ArgN</strong> – Decimal values to load in scratchpad</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="k">load</span> <span class="n">s1</span><span class="p">,</span> <span class="n">my_array</span>
<span class="nb">storetable(</span><span class="mh">0x10</span><span class="p">,</span> <span class="s">sF</span><span class="p">,</span> <span class="nb">pbhex(</span><span class="mh">DE</span><span class="p">,</span><span class="mh">AD</span><span class="p">,</span><span class="mh">BE</span><span class="p">,</span><span class="mh">EF</span><span class="nb">))</span> <span class="c">; Load DE,AD,BE,EF into memory</span>
<span class="nb">storetable(</span><span class="mh">0x10</span><span class="p">,</span> <span class="s">sF</span><span class="p">,</span> <span class="m">10</span><span class="p">,</span> <span class="m">11</span><span class="p">,</span> <span class="m">12</span><span class="nb">)</span>         <span class="c">; Load decimals</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.storetableat">
<code class="descname">storetableat</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3-ArgN</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.storetableat" title="Permalink to this definition">¶</a></dt>
<dd><p>Store a table of constants in scratchpad RAM.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Pointer register to scratchpad address</li>
<li><strong>Arg2</strong> – Temporary register for each constant</li>
<li><strong>Arg3-ArgN</strong> – Decimal values to load in scratchpad</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The pointer register will finish with the address of the last byte in the table.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="k">load</span> <span class="n">s1</span><span class="p">,</span> <span class="n">my_array</span>
<span class="nb">storetableat(</span><span class="s">s1</span><span class="p">,</span> <span class="s">sF</span><span class="p">,</span> <span class="nb">pbhex(</span><span class="mh">DE</span><span class="p">,</span><span class="mh">AD</span><span class="p">,</span><span class="mh">BE</span><span class="p">,</span><span class="mh">EF</span><span class="nb">))</span> <span class="c">; Load DE,AD,BE,EF into memory</span>
<span class="nb">storetableat(</span><span class="s">s1</span><span class="p">,</span> <span class="s">sF</span><span class="p">,</span> <span class="m">10</span><span class="p">,</span> <span class="m">11</span><span class="p">,</span> <span class="m">12</span><span class="nb">)</span>         <span class="c">; Load decimals</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.strhash">
<code class="descname">strhash</code><span class="sig-paren">(</span><em>Arg1</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.strhash" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a 16-bit checksum constant from a string using the BSD algorithm.
This does not dynamically compute a hash from variable data. It can be used to seed a PRNG
from a build time string like a timestamp.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – String to compute hash over</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">strhash(</span><span class="s">`Hello</span> <span class="s">world&#39;</span><span class="nb">)</span>  <span class="c">; Expands to 27566</span>

<span class="nb">reg16(</span><span class="s">RS</span><span class="p">,</span> <span class="s">s0</span><span class="p">,</span> <span class="s">s1</span><span class="nb">)</span>
<span class="nb">load16(</span><span class="s">RS</span><span class="p">,</span> <span class="nb">strhash(</span><span class="s">DATE_STAMP</span> <span class="s">TIME_STAMP</span><span class="nb">))</span> <span class="c">; Seed the PRNG with the build time</span>
<span class="k">call</span> <span class="n">random16</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.strlenc">
<code class="descname">strlenc</code><span class="sig-paren">(</span><em>Arg1</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.strlenc" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the length of a string constant, a portable string or a packed string.
The argument is passed through the <a class="reference internal" href="#pb.estr" title="estr"><code class="xref pb pb-macro docutils literal"><span class="pre">estr()</span></code></a> macro to collapse escaped characters
before counting them.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – String to count length from. This is either a constant or the label to a string
defined with string() or packed_string()</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="nb">strlenc(</span><span class="s">`foobar\r\n&#39;</span><span class="nb">)</span>  <span class="c">; Expands to 8</span>

<span class="nb">packed_string(</span><span class="s">xyzzy</span><span class="p">,</span> <span class="s">`This</span> <span class="s">is</span> <span class="s">a</span> <span class="s">string&#39;</span><span class="nb">)</span>
<span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="nb">strlenc(</span><span class="s">xyzzy</span><span class="nb">)</span> <span class="c">; Expands to 16</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.sub16">
<code class="descname">sub16</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em><span class="optional">[</span>, <em>Arg4</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.sub16" title="Permalink to this definition">¶</a></dt>
<dd><p>16-bit subtraction.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Arg1</strong> – MSB1 register</li>
<li><strong>Arg2</strong> – LSB1 register</li>
<li><strong>Arg3</strong> – Decimal constant or expression or MSB2 when Arg4 is present</li>
<li><strong>Arg4</strong> – Optional register for LSB2</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Result in Arg1, Arg2</p>
</td>
</tr>
</tbody>
</table>
<p>When three arguments are passed, Arg3 is a constant literal. When four arguments are passed,
Arg3 and Arg4 are a 16-bit pair to add to the result.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">sub16(</span><span class="s">s1</span><span class="p">,</span><span class="s">s0</span><span class="p">,</span> <span class="mh">0x1234</span><span class="nb">)</span> <span class="c">; s1,s0 -= 0x1234</span>
<span class="nb">sub16(</span><span class="s">s1</span><span class="p">,</span><span class="s">s0</span><span class="p">,</span> <span class="s">s3</span><span class="p">,</span><span class="s">s2</span><span class="nb">)</span>  <span class="c">; s1,s0 -= s3,s2</span>
<span class="nb">sub16(</span><span class="s">rx</span><span class="p">,</span> <span class="s">ry</span><span class="nb">)</span>        <span class="c">; rx    -= ry</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.swap">
<code class="descname">swap</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.swap" title="Permalink to this definition">¶</a></dt>
<dd><p>Swap registers.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Register 1</li>
<li><strong>Arg2</strong> – Register 2</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">swap(</span><span class="s">s0</span><span class="p">,</span> <span class="s">s1</span><span class="nb">)</span> <span class="c">; s1 -&gt; s0 and s0 -&gt; s1</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.test16">
<code class="descname">test16</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em><span class="optional">[</span>, <em>Arg4</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.test16" title="Permalink to this definition">¶</a></dt>
<dd><p>16-bit test.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – MSB1</li>
<li><strong>Arg2</strong> – LSB1</li>
<li><strong>Arg3</strong> – Decimal constant or expression or MSB2 when Arg4 is present</li>
<li><strong>Arg4</strong> – Optional register for LSB2</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>When three arguments are passed, Arg3 is a constant literal. When four arguments are passed,
Arg3 and Arg4 are a 16-bit pair to use with the TEST comparison.
.. note:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="n">On</span> <span class="n">PicoBlaze</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="n">only</span> <span class="n">the</span> <span class="n">Z</span> <span class="n">flag</span> <span class="ow">is</span> <span class="nb">set</span> <span class="n">properly</span><span class="o">.</span> <span class="n">On</span> <span class="n">PicoBlaze</span><span class="o">-</span><span class="mi">6</span> <span class="n">the</span> <span class="n">C</span> <span class="n">flag</span> <span class="n">contains</span> <span class="n">the</span> <span class="n">XOR</span>
<span class="p">(</span><span class="n">odd</span> <span class="n">parity</span><span class="p">)</span> <span class="n">of</span> <span class="nb">all</span> <span class="n">bits</span><span class="o">.</span>
</pre></div>
</div>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">load16(</span><span class="s">s1</span><span class="p">,</span><span class="s">s0</span><span class="p">,</span> <span class="mh">0x10F0</span><span class="nb">)</span>
<span class="nb">test16(</span><span class="s">s1</span><span class="p">,</span><span class="s">s0</span><span class="p">,</span> <span class="mh">0x0080</span><span class="nb">)</span>  <span class="c">; Z flag is clear</span>
<span class="nb">test16(</span><span class="s">s1</span><span class="p">,</span><span class="s">s0</span><span class="p">,</span> <span class="mh">0x0800</span><span class="nb">)</span>  <span class="c">; Z flag is set</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.testbit">
<code class="descname">testbit</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.testbit" title="Permalink to this definition">¶</a></dt>
<dd><p>Test if a bit is set or clear.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Register to test</li>
<li><strong>Arg2</strong> – Bit number (0-7) to test</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Z is set if bit is clear, Z is clear if bit is set</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">testbit(</span><span class="s">s1</span><span class="p">,</span> <span class="m">3</span><span class="nb">)</span>
<span class="k">jump</span> <span class="n">z</span><span class="p">,</span> <span class="n">bit_cleared</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.uniqlabel">
<code class="descname">uniqlabel</code><span class="sig-paren">(</span><span class="optional">[</span><em>Arg1</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.uniqlabel" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a unique name for a label.
The labels will be unique to each included file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Optional prefix to name</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">uniqlabel(</span><span class="s">PREFIX_</span><span class="nb">)</span> <span class="c">; Expands to &quot;__PREFIX_f0_0001&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.use_ascii2bcd">
<code class="descname">use_ascii2bcd</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_ascii2bcd" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a function to convert an ASCII number to BCD.
Invalid characters are converted to “0” digits.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Arg1</strong> – Name of function to generate</li>
<li><strong>Arg2</strong> – Register for first function argument,
the scratchpad address of the ASCII data</li>
<li><strong>Arg3</strong> – Register for length of the data</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The generated function has no return value. All registers are
preserved on the stack.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">use_ascii2bcd(</span><span class="s">ascii2bcd</span><span class="p">,</span> <span class="s">s0</span><span class="p">,</span> <span class="s">s1</span><span class="nb">)</span>
<span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="mh">20</span> <span class="c">; Array address</span>
<span class="k">load</span> <span class="n">s1</span><span class="p">,</span> <span class="mh">05</span> <span class="c">; Length</span>
<span class="k">call</span> <span class="n">ascii2bcd</span>
<span class="c">; The array now contains all BCD digits</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.use_bcd2int">
<code class="descname">use_bcd2int</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em>, <em>Arg4</em>, <em>Arg5</em>, <em>Arg6</em>, <em>Arg7</em>, <em>Arg8</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_bcd2int" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a function to convert an unpacked BCD coded bytes to a
variable size integer.</p>
<p>The BCD input is stored in a buffer in
scratchpad memory. The buffer address and length are passed as arguments.
The converted result is overwritten to the leftmost portion of the buffer.
The length register returns with the number of bytes in the result.
This function handles conversion to any size integer as the result is
guaranteed to be smaller than the initial buffer.
Internal temp registers must be allocated for use by the macro. They must
not include the _tempreg register.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Arg1</strong> – Name of function to generate</li>
<li><strong>Arg2</strong> – First argument of generated function.
Register with scratchpad BCD address</li>
<li><strong>Arg3</strong> – Register with number of bytes for scratchpad buffer</li>
<li><strong>Arg4</strong> – Internal temp register</li>
<li><strong>Arg5</strong> – Internal temp register</li>
<li><strong>Arg6</strong> – Internal temp register</li>
<li><strong>Arg7</strong> – Internal temp register</li>
<li><strong>Arg8</strong> – Internal temp register</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The converted integer value is located at the start of the buffer with the LSB
first, opposite to the order of the BCD digits.
The number of bytes in the converted integer is returned in the second argument
to the function (Arg3 of this generator macro). All other registers are preserved
on the stack.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">use_bcd2int(</span><span class="s">bcd2int</span><span class="p">,</span> <span class="s">s0</span><span class="p">,</span> <span class="s">s1</span><span class="p">,</span> <span class="s">s2</span><span class="p">,</span><span class="s">s3</span><span class="p">,</span><span class="s">s4</span><span class="p">,</span><span class="s">s5</span><span class="p">,</span><span class="s">s6</span><span class="nb">)</span>
<span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="mh">20</span> <span class="c">; BCD buffer</span>
<span class="k">load</span> <span class="n">s1</span><span class="p">,</span> <span class="mh">03</span> <span class="c">; 3 BCD digits long</span>
<span class="k">call</span> <span class="n">bcd2int</span>
<span class="c">; s1 contains the number of converted bytes</span>
<span class="c">; scratchpad 20 (and possibly 21) contain the binary result</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.use_bcdwrite">
<code class="descname">use_bcdwrite</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em>, <em>Arg4</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_bcdwrite" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a function to write an array of BCD coded bytes to an output port.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Arg1</strong> – Name of function to generate</li>
<li><strong>Arg2</strong> – Register for first function argument,
the scratchpad address of the source BCD data</li>
<li><strong>Arg3</strong> – Register for number of bytes to write</li>
<li><strong>Arg4</strong> – Port address to write. This is a fixed value that can’t
be changed at runtime</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The generated function has no return value. All registers are
preserved on the stack.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="k">constant</span> <span class="n">ConsolePort</span><span class="p">,</span> <span class="mh">FE</span>
<span class="nb">use_bcdwrite(</span><span class="s">bcdwrite</span><span class="p">,</span> <span class="s">s0</span><span class="p">,</span> <span class="s">s1</span><span class="p">,</span> <span class="s">ConsolePort</span><span class="nb">)</span>
<span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="mh">20</span> <span class="c">; Source address</span>
<span class="k">load</span> <span class="n">s1</span><span class="p">,</span> <span class="mh">05</span> <span class="c">; Write 5 bytes</span>
<span class="k">call</span> <span class="n">bcdwrite</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.use_clock">
<code class="descname">use_clock</code><span class="sig-paren">(</span><em>Arg1</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_clock" title="Permalink to this definition">¶</a></dt>
<dd><p>Define system clock frequency.</p>
<p><strong>Only invoke once. Must be executed before any delay macros.</strong></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Clock frequency in MHz. Limited to integer values.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">use_clock(</span><span class="m">50</span><span class="nb">)</span> <span class="c">; 50 MHz clock</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.use_delay_reg">
<code class="descname">use_delay_reg</code><span class="sig-paren">(</span><em>Arg1</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_delay_reg" title="Permalink to this definition">¶</a></dt>
<dd><p>Define delay loop register.</p>
<p><strong>Only invoke once. Must be executed before any delay macros.</strong>
This register must be different from the registers used in the delay_us() and delay_ms() macros.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Register to use for inner loop counter</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">use_delay_reg(</span><span class="s">sA</span><span class="nb">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.use_divide16x8">
<code class="descname">use_divide16x8</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em>, <em>Arg4</em>, <em>Arg5</em>, <em>Arg6</em>, <em>Arg7</em><span class="optional">[</span>, <em>Arg8</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_divide16x8" title="Permalink to this definition">¶</a></dt>
<dd><p>Divide 16 / 8 subroutine. Implements truncating division.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Subroutine name</li>
<li><strong>Arg2</strong> – Dividend MSB</li>
<li><strong>Arg3</strong> – Dividend LSB</li>
<li><strong>Arg4</strong> – Divisor</li>
<li><strong>Arg5</strong> – Quotient MSB</li>
<li><strong>Arg6</strong> – Quotient LSB</li>
<li><strong>Arg7</strong> – Remainder</li>
<li><strong>Arg8</strong> – Optional preamble code block. Also supresses return statement if present.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The temp register is overwritten. It is sE by default. Call use_tempreg(reg_name)
before invoking this macro to change it. The MSB of the dividend is destroyed.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">use_divide16x8(</span><span class="s">div16</span><span class="p">,</span> <span class="s">s0</span><span class="p">,</span><span class="s">s1</span><span class="p">,</span> <span class="s">s2</span><span class="p">,</span> <span class="s">s3</span><span class="p">,</span><span class="s">s4</span><span class="p">,</span> <span class="s">s5</span><span class="nb">)</span> <span class="c">; (s3,s4) (rem s5) &lt;= (s0,s1) / s2</span>
<span class="nb">load16(</span><span class="s">s0</span><span class="p">,</span><span class="s">s1</span><span class="p">,</span> <span class="m">400</span><span class="nb">)</span>
<span class="k">load</span> <span class="n">s2</span><span class="p">,</span> <span class="m">5&#39;d</span>
<span class="k">call</span> <span class="n">div16</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.use_divide16x8s">
<code class="descname">use_divide16x8s</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em>, <em>Arg4</em>, <em>Arg5</em>, <em>Arg6</em>, <em>Arg7</em><span class="optional">[</span>, <em>Arg8</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_divide16x8s" title="Permalink to this definition">¶</a></dt>
<dd><p>Signed Divide 16 / 8 subroutine. Implements truncating division.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Subroutine name</li>
<li><strong>Arg2</strong> – Dividend MSB (signed)</li>
<li><strong>Arg3</strong> – Dividend LSB</li>
<li><strong>Arg4</strong> – Divisor      (signed)</li>
<li><strong>Arg5</strong> – Quotient MSB (signed)</li>
<li><strong>Arg6</strong> – Quotient LSB</li>
<li><strong>Arg7</strong> – Remainder</li>
<li><strong>Arg8</strong> – Optional preamble code block. Also supresses return statement if present.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The temp register is overwritten. It is sE by default. Call use_tempreg(reg_name)
before invoking this macro to change it. The MSB of the dividend is destroyed.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">use_divide16x8s(</span><span class="s">div16</span><span class="p">,</span> <span class="s">s0</span><span class="p">,</span><span class="s">s1</span><span class="p">,</span> <span class="s">s2</span><span class="p">,</span> <span class="s">s3</span><span class="p">,</span><span class="s">s4</span><span class="p">,</span> <span class="s">s5</span><span class="nb">)</span> <span class="c">; (s3,s4) (rem s5) &lt;= (s0,s1) / s2</span>
<span class="nb">load16(</span><span class="s">s0</span><span class="p">,</span><span class="s">s1</span><span class="p">,</span> <span class="o">-</span><span class="m">400</span><span class="nb">)</span>
<span class="k">load</span> <span class="n">s2</span><span class="p">,</span> <span class="m">5&#39;d</span>
<span class="k">call</span> <span class="n">div16</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.use_divide8x8">
<code class="descname">use_divide8x8</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em>, <em>Arg4</em>, <em>Arg5</em><span class="optional">[</span>, <em>Arg6</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_divide8x8" title="Permalink to this definition">¶</a></dt>
<dd><p>Divide 8 / 8 subroutine. Implements truncating division.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Subroutine name</li>
<li><strong>Arg2</strong> – Dividend</li>
<li><strong>Arg3</strong> – Divisor</li>
<li><strong>Arg4</strong> – Quotient</li>
<li><strong>Arg5</strong> – Remainder</li>
<li><strong>Arg6</strong> – Optional preamble code block. Also supresses return statement if present.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The temp register is overwritten. It is sE by default. Call use_tempreg(reg_name)
before invoking this macro to change it.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">use_divide8x8(</span><span class="s">div8</span><span class="p">,</span> <span class="s">s0</span><span class="p">,</span> <span class="s">s1</span><span class="p">,</span> <span class="s">s2</span><span class="p">,</span> <span class="s">s3</span><span class="nb">)</span> <span class="c">; s2 (rem s3) &lt;= s0 / s1</span>
<span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="m">20&#39;d</span>
<span class="k">load</span> <span class="n">s1</span><span class="p">,</span> <span class="m">4&#39;d</span>
<span class="k">call</span> <span class="n">div8</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.use_divide8x8s">
<code class="descname">use_divide8x8s</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em>, <em>Arg4</em>, <em>Arg5</em><span class="optional">[</span>, <em>Arg6</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_divide8x8s" title="Permalink to this definition">¶</a></dt>
<dd><p>Signed Divide 8 / 8 subroutine. Implements truncating division.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Subroutine name</li>
<li><strong>Arg2</strong> – Dividend (signed)</li>
<li><strong>Arg3</strong> – Divisor (signed)</li>
<li><strong>Arg4</strong> – Quotient</li>
<li><strong>Arg5</strong> – Remainder</li>
<li><strong>Arg6</strong> – Optional preamble code block. Also supresses return statement if present.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Same arguments as unsigned 8 / 8 divide.
.. seealso:: <a class="reference internal" href="#pb.use_divide8x8" title="use_divide8x8"><code class="xref pb pb-macro docutils literal"><span class="pre">use_divide8x8()</span></code></a> for more information.</p>
</dd></dl>

<dl class="macro">
<dt id="pb.use_divide8xk">
<code class="descname">use_divide8xk</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em>, <em>Arg4</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_divide8xk" title="Permalink to this definition">¶</a></dt>
<dd><p>Divide 8 / constant subroutine with 8-bit result.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Subroutine name</li>
<li><strong>Arg2</strong> – Dividend</li>
<li><strong>Arg3</strong> – Constant divisor (can be wider than 8-bits)</li>
<li><strong>Arg4</strong> – Result quotient</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">use_divide8xk(</span><span class="s">div8k5</span><span class="p">,</span> <span class="s">s0</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="s">s4</span><span class="nb">)</span>  <span class="c">; s4 = s0 / 5</span>
<span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="m">30&#39;d</span>
<span class="k">call</span> <span class="n">div8k5</span>    <span class="c">; 30 / 5 =&gt; 6</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.use_expr_all">
<code class="descname">use_expr_all</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_expr_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Configure all multiplication and divide subroutines.
Use this in conjunction with Opbasm’s dead code removal to guarantee that
only the arithmetic subroutines in use will be assembled.
This is equivalent to calling the following macros with no arguments:</p>
<ul class="simple">
<li><a class="reference internal" href="#pb.use_expr_mul" title="use_expr_mul"><code class="xref pb pb-macro docutils literal"><span class="pre">use_expr_mul()</span></code></a></li>
<li><a class="reference internal" href="#pb.use_expr_muls" title="use_expr_muls"><code class="xref pb pb-macro docutils literal"><span class="pre">use_expr_muls()</span></code></a></li>
<li><a class="reference internal" href="#pb.use_expr_mulsu" title="use_expr_mulsu"><code class="xref pb pb-macro docutils literal"><span class="pre">use_expr_mulsu()</span></code></a></li>
<li><a class="reference internal" href="#pb.use_expr_div" title="use_expr_div"><code class="xref pb pb-macro docutils literal"><span class="pre">use_expr_div()</span></code></a></li>
<li><a class="reference internal" href="#pb.use_expr_divs" title="use_expr_divs"><code class="xref pb pb-macro docutils literal"><span class="pre">use_expr_divs()</span></code></a></li>
<li><a class="reference internal" href="#pb.use_expr_div16" title="use_expr_div16"><code class="xref pb pb-macro docutils literal"><span class="pre">use_expr_div16()</span></code></a></li>
<li><a class="reference internal" href="#pb.use_expr_div16s" title="use_expr_div16s"><code class="xref pb pb-macro docutils literal"><span class="pre">use_expr_div16s()</span></code></a></li>
</ul>
</dd></dl>

<dl class="macro">
<dt id="pb.use_expr_div">
<code class="descname">use_expr_div</code><span class="sig-paren">(</span><span class="optional">[</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em>, <em>Arg4</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_expr_div" title="Permalink to this definition">¶</a></dt>
<dd><p>Configure unsigned division for expressions.
All arguments are optional.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Arg1</strong> – Optional Dividend (default is s8)</li>
<li><strong>Arg2</strong> – Optional Divisor  (default is s9)</li>
<li><strong>Arg3</strong> – Optional Internal result Quotient (default is sA) preserved on stack</li>
<li><strong>Arg4</strong> – Optional Internal result Remainder (default is sB) preserved on stack</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The result is copied to Arg1, Arg2</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="macro">
<dt id="pb.use_expr_div16">
<code class="descname">use_expr_div16</code><span class="sig-paren">(</span><span class="optional">[</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em>, <em>Arg4</em>, <em>Arg5</em>, <em>Arg6</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_expr_div16" title="Permalink to this definition">¶</a></dt>
<dd><p>Configure unsigned 16x8 division for expressions. This creates a new function “expr_div16”
used by the expr2() macro.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Arg1</strong> – Optional MSB of Dividend (default is s7)</li>
<li><strong>Arg2</strong> – Optional LSB of Dividend (default is s8)</li>
<li><strong>Arg3</strong> – Optional Divisor  (default is s9)</li>
<li><strong>Arg4</strong> – Optional MSB of Quotient (default is sA)</li>
<li><strong>Arg5</strong> – Optional LSB of Quotient (default is sB)</li>
<li><strong>Arg6</strong> – Optional Remainder (default is sC)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The generated function places the quotient in Arg1,Arg2 and the remainder in Arg3.</p>
</td>
</tr>
</tbody>
</table>
<p>Arg4-6 act as temp registers and are restored
from the stack.</p>
</dd></dl>

<dl class="macro">
<dt id="pb.use_expr_div16s">
<code class="descname">use_expr_div16s</code><span class="sig-paren">(</span><span class="optional">[</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em>, <em>Arg4</em>, <em>Arg5</em>, <em>Arg6</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_expr_div16s" title="Permalink to this definition">¶</a></dt>
<dd><p>Configure signed 16x8 division for expressions. This creates a new function “expr_div16s”
used by the expr2s() macro.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Arg1</strong> – Optional MSB of Dividend (default is s7)</li>
<li><strong>Arg2</strong> – Optional LSB of Dividend (default is s8)</li>
<li><strong>Arg3</strong> – Optional Divisor  (default is s9)</li>
<li><strong>Arg4</strong> – Optional MSB of Quotient (default is sA)</li>
<li><strong>Arg5</strong> – Optional LSB of Quotient (default is sB)</li>
<li><strong>Arg6</strong> – Optional Remainder (default is sC)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The generated function places the quotient in Arg1,Arg2 and the remainder in Arg3.</p>
</td>
</tr>
</tbody>
</table>
<p>Arg4-6 act as temp registers and are restored
from the stack.</p>
</dd></dl>

<dl class="macro">
<dt id="pb.use_expr_divs">
<code class="descname">use_expr_divs</code><span class="sig-paren">(</span><span class="optional">[</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em>, <em>Arg4</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_expr_divs" title="Permalink to this definition">¶</a></dt>
<dd><p>Configure signed division for expressions.
All arguments are optional.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Arg1</strong> – Optional Dividend (default is s8)</li>
<li><strong>Arg2</strong> – Optional Divisor  (default is s9)</li>
<li><strong>Arg3</strong> – Optional Internal result Quotient (default is sA) preserved on stack</li>
<li><strong>Arg4</strong> – Optional Internal result Remainder (default is sB) preserved on stack</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The result is copied to Arg1, Arg2</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="macro">
<dt id="pb.use_expr_mul">
<code class="descname">use_expr_mul</code><span class="sig-paren">(</span><span class="optional">[</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em>, <em>Arg4</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_expr_mul" title="Permalink to this definition">¶</a></dt>
<dd><p>Configure unsigned multiplication for expressions.
All arguments are optional.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Arg1</strong> – Optional Multiplicand (default is s8)</li>
<li><strong>Arg2</strong> – Optional Multiplier   (default is s9)</li>
<li><strong>Arg3</strong> – Optional Internal result MSB (default is sA) preserved on stack</li>
<li><strong>Arg4</strong> – Optional Internal result LSB (default is sB) preserved on stack</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The result is copied to Arg1, Arg2</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="macro">
<dt id="pb.use_expr_muls">
<code class="descname">use_expr_muls</code><span class="sig-paren">(</span><span class="optional">[</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em>, <em>Arg4</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_expr_muls" title="Permalink to this definition">¶</a></dt>
<dd><p>Configure signed multiplication for expressions.
All arguments are optional.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Arg1</strong> – Optional Multiplicand (default is s8)</li>
<li><strong>Arg2</strong> – Optional Multiplier   (default is s9)</li>
<li><strong>Arg3</strong> – Optional Internal result MSB (default is sA) preserved on stack</li>
<li><strong>Arg4</strong> – Optional Internal result LSB (default is sB) preserved on stack</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The result is copied to Arg1, Arg2</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="macro">
<dt id="pb.use_expr_mulsu">
<code class="descname">use_expr_mulsu</code><span class="sig-paren">(</span><span class="optional">[</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em>, <em>Arg4</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_expr_mulsu" title="Permalink to this definition">¶</a></dt>
<dd><p>Configure signedxunsigned (16x8) multiplication for expressions.
All arguments are optional.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Arg1</strong> – Optional Multiplicand (default is s8)</li>
<li><strong>Arg2</strong> – Optional Multiplier   (default is s9)</li>
<li><strong>Arg3</strong> – Optional Internal result MSB (default is sA) preserved on stack</li>
<li><strong>Arg4</strong> – Optional Internal result LSB (default is sB) preserved on stack</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The result is copied to Arg1, Arg2</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="macro">
<dt id="pb.use_hexwrite">
<code class="descname">use_hexwrite</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em>, <em>Arg4</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_hexwrite" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a function to write an array to an output port as ASCII hex.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Arg1</strong> – Name of function to generate</li>
<li><strong>Arg2</strong> – Register for first function argument,
the scratchpad address of the source data</li>
<li><strong>Arg3</strong> – Register for number of bytes to write</li>
<li><strong>Arg4</strong> – Port address to write. This is a fixed value that can’t
be changed at runtime</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The generated function has no return value. All registers are
preserved on the stack.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="k">constant</span> <span class="n">ConsolePort</span><span class="p">,</span> <span class="mh">FE</span>
<span class="nb">use_hexwrite(</span><span class="s">hexwrite</span><span class="p">,</span> <span class="s">s0</span><span class="p">,</span> <span class="s">s1</span><span class="p">,</span> <span class="s">ConsolePort</span><span class="nb">)</span>
<span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="mh">20</span> <span class="c">; Source address</span>
<span class="k">load</span> <span class="n">s1</span><span class="p">,</span> <span class="mh">05</span> <span class="c">; Write 5 bytes</span>
<span class="k">call</span> <span class="n">hexwrite</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.use_int2bcd">
<code class="descname">use_int2bcd</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em>, <em>Arg4</em>, <em>Arg5</em>, <em>Arg6</em>, <em>Arg7</em>, <em>Arg8</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_int2bcd" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a function to convert an integer to unpacked BCD coded
bytes stored in a scratchpad buffer.</p>
<p>The number to convert is passed on the stack as one or more bytes
with the MSB pushed last. The buffer size is fixed after generating
the function. You must ensure it is large enough to contain the
largest integer you expect to convert. Each buffer byte corresponds to
one decimal digit. The converted BCD number is right justified within
the buffer with leading 0’s for padding. The least significant digit
is always at the end of the buffer.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Arg1</strong> – Name of function to generate</li>
<li><strong>Arg2</strong> – Number of bytes for scratchpad buffer (fixed constant)</li>
<li><strong>Arg3</strong> – First argument of generated function.
Register with destination scratchpad address</li>
<li><strong>Arg4</strong> – Register containing number of bytes of data to convert
on the stack</li>
<li><strong>Arg5</strong> – Internal temp register</li>
<li><strong>Arg6</strong> – Internal temp register</li>
<li><strong>Arg7</strong> – Internal temp register</li>
<li><strong>Arg8</strong> – Internal temp register</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The generated function has no return value. All registers are
preserved on the stack.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">use_int2bcd(</span><span class="s">int2bcd</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="s">s0</span><span class="p">,</span> <span class="s">s1</span><span class="p">,</span> <span class="s">s2</span><span class="p">,</span> <span class="s">s3</span><span class="p">,</span> <span class="s">s4</span><span class="p">,</span> <span class="s">s5</span><span class="nb">)</span> <span class="c">; Support up to 5 decimal digits</span>
<span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="mh">20</span> <span class="c">; Dest address</span>
<span class="k">load</span> <span class="n">s1</span><span class="p">,</span> <span class="mh">02</span> <span class="c">; Convert 16-bit number (2-bytes)</span>
<span class="nb">load16(</span><span class="s">s4</span><span class="p">,</span><span class="s">s3</span><span class="p">,</span> <span class="m">31337</span><span class="nb">)</span>
<span class="nb">push(</span><span class="s">s3</span><span class="p">,</span><span class="s">s4</span><span class="nb">)</span> <span class="c">; Put number to convert on stack; LSB then MSB</span>
<span class="k">call</span> <span class="n">int2bcd</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.use_memcopy">
<code class="descname">use_memcopy</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em>, <em>Arg4</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_memcopy" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a function to copy an array in scratchpad memory.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Arg1</strong> – Name of function to generate</li>
<li><strong>Arg2</strong> – Register for first function argument,
the scratchpad address of the source array</li>
<li><strong>Arg3</strong> – Register for destination address</li>
<li><strong>Arg4</strong> – Register for number of bytes to copy</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The generated function has no return value. All registers are
preserved on the stack.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">use_memcopy(</span><span class="s">memcopy</span><span class="p">,</span> <span class="s">s0</span><span class="p">,</span> <span class="s">s1</span><span class="p">,</span> <span class="s">s2</span><span class="nb">)</span>
<span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="mh">20</span> <span class="c">; Source address</span>
<span class="k">load</span> <span class="n">s1</span><span class="p">,</span> <span class="mh">30</span> <span class="c">; Dest address</span>
<span class="k">load</span> <span class="n">s2</span><span class="p">,</span> <span class="mh">05</span> <span class="c">; Copy 5 bytes</span>
<span class="k">call</span> <span class="n">memcopy</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.use_memset">
<code class="descname">use_memset</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em>, <em>Arg4</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_memset" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a function to set an array in scratchpad memory.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Arg1</strong> – Name of function to generate</li>
<li><strong>Arg2</strong> – Register for first function argument,
the scratchpad address of the destination array</li>
<li><strong>Arg3</strong> – Register for number of bytes to copy</li>
<li><strong>Arg4</strong> – Register for value to set array bytes to</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The generated function has no return value. All registers are
preserved on the stack.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">use_memset(</span><span class="s">memset</span><span class="p">,</span> <span class="s">s0</span><span class="p">,</span> <span class="s">s1</span><span class="p">,</span> <span class="s">s2</span><span class="nb">)</span>
<span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="mh">20</span> <span class="c">; Destination address</span>
<span class="k">load</span> <span class="n">s1</span><span class="p">,</span> <span class="mh">05</span> <span class="c">; Copy 5 bytes</span>
<span class="k">load</span> <span class="n">s2</span><span class="p">,</span> <span class="mh">00</span> <span class="c">; Set all bytes to 0</span>
<span class="k">call</span> <span class="n">memset</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.use_memwrite">
<code class="descname">use_memwrite</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em>, <em>Arg4</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_memwrite" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a function to write an array of bytes to an output port.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Arg1</strong> – Name of function to generate</li>
<li><strong>Arg2</strong> – Register for first function argument,
the scratchpad address of the source array</li>
<li><strong>Arg3</strong> – Register for number of bytes to write</li>
<li><strong>Arg4</strong> – Port address to write. This is a fixed value that can’t
be changed at runtime</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The generated function has no return value. All registers are
preserved on the stack.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="k">constant</span> <span class="n">ConsolePort</span><span class="p">,</span> <span class="mh">FE</span>
<span class="nb">use_memwrite(</span><span class="s">memwrite</span><span class="p">,</span> <span class="s">s0</span><span class="p">,</span> <span class="s">s1</span><span class="p">,</span> <span class="s">ConsolePort</span><span class="nb">)</span>
<span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="mh">20</span> <span class="c">; Source address</span>
<span class="k">load</span> <span class="n">s1</span><span class="p">,</span> <span class="mh">05</span> <span class="c">; Write 5 bytes</span>
<span class="k">call</span> <span class="n">memwrite</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.use_multiply8x8">
<code class="descname">use_multiply8x8</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em>, <em>Arg4</em>, <em>Arg5</em><span class="optional">[</span>, <em>Arg6</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_multiply8x8" title="Permalink to this definition">¶</a></dt>
<dd><p>Multiply 8 x 8 subroutine.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Subroutine name</li>
<li><strong>Arg2</strong> – Multiplicand</li>
<li><strong>Arg3</strong> – Multiplier</li>
<li><strong>Arg4</strong> – Result MSB</li>
<li><strong>Arg5</strong> – Result LSB</li>
<li><strong>Arg6</strong> – Optional preamble code block. Also supresses return statement if present.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The temp register is overwritten. It is sE by default. Call use_tempreg(reg_name)
before invoking this macro to change it. The optional code block can be used to insert
initialization code at the beginning of the generated subroutine. The final <code class="docutils literal"><span class="pre">return</span></code> is
omitted so that you can also append finalization code. You must provide an explicit <code class="docutils literal"><span class="pre">return</span></code>
when the preamble block is in use.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">use_multiply8x8(</span><span class="s">mul8</span><span class="p">,</span> <span class="s">s0</span><span class="p">,</span> <span class="s">s1</span><span class="p">,</span> <span class="s">s3</span><span class="p">,</span> <span class="s">s2</span><span class="nb">)</span> <span class="c">; (s3, s2) = s0 * s1</span>
<span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="mh">04</span>
<span class="k">load</span> <span class="n">s1</span><span class="p">,</span> <span class="mh">05</span>
<span class="k">call</span> <span class="n">mul8</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.use_multiply8x8s">
<code class="descname">use_multiply8x8s</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em>, <em>Arg4</em>, <em>Arg5</em><span class="optional">[</span>, <em>Arg6</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_multiply8x8s" title="Permalink to this definition">¶</a></dt>
<dd><p>Signed Multiply 8 x 8 subroutine.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Subroutine name</li>
<li><strong>Arg2</strong> – Multiplicand (signed)</li>
<li><strong>Arg3</strong> – Multiplier (signed)</li>
<li><strong>Arg4</strong> – Result MSB</li>
<li><strong>Arg5</strong> – Result LSB</li>
<li><strong>Arg6</strong> – Optional preamble code block. Also supresses return statement if present.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Same arguments as unsigned multiply. Both arguments are treated as signed numbers.
.. seealso:: <a class="reference internal" href="#pb.use_multiply8x8" title="use_multiply8x8"><code class="xref pb pb-macro docutils literal"><span class="pre">use_multiply8x8()</span></code></a> for more information.</p>
</dd></dl>

<dl class="macro">
<dt id="pb.use_multiply8x8su">
<code class="descname">use_multiply8x8su</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em>, <em>Arg4</em>, <em>Arg5</em><span class="optional">[</span>, <em>Arg6</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_multiply8x8su" title="Permalink to this definition">¶</a></dt>
<dd><p>SignedxUnsigned Multiply 8 x 8 subroutine.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Subroutine name</li>
<li><strong>Arg2</strong> – Multiplicand (signed)</li>
<li><strong>Arg3</strong> – Multiplier (unsigned)</li>
<li><strong>Arg4</strong> – Result MSB</li>
<li><strong>Arg5</strong> – Result LSB</li>
<li><strong>Arg6</strong> – Optional preamble code block. Also supresses return statement if present.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Same arguments as unsigned multiply. Only the multiplicand is treated as signed.
.. seealso:: <a class="reference internal" href="#pb.use_multiply8x8" title="use_multiply8x8"><code class="xref pb pb-macro docutils literal"><span class="pre">use_multiply8x8()</span></code></a> for more information.</p>
</dd></dl>

<dl class="macro">
<dt id="pb.use_multiply8xk">
<code class="descname">use_multiply8xk</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em>, <em>Arg4</em>, <em>Arg5</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_multiply8xk" title="Permalink to this definition">¶</a></dt>
<dd><p>Multiply 8 x constant subroutine with 16-bit result.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Subroutine name</li>
<li><strong>Arg2</strong> – Multiplicand</li>
<li><strong>Arg3</strong> – Constant multiplier (can be wider than 8-bits)</li>
<li><strong>Arg4</strong> – Result MSB</li>
<li><strong>Arg5</strong> – Result LSB</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">use_multiply8xk(</span><span class="s">mul8k5</span><span class="p">,</span> <span class="s">s0</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="s">s5</span><span class="p">,</span> <span class="s">s4</span><span class="nb">)</span>  <span class="c">; (s5, s4) = s0 * 5</span>
<span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="m">7&#39;d</span>
<span class="k">call</span> <span class="n">mul8k5</span>   <span class="c">; 7 * 5 =&gt; 35</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.use_multiply8xk_small">
<code class="descname">use_multiply8xk_small</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em>, <em>Arg4</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_multiply8xk_small" title="Permalink to this definition">¶</a></dt>
<dd><p>Multiply 8 x constant subroutine with 8-bit result.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Subroutine name</li>
<li><strong>Arg2</strong> – Multiplicand</li>
<li><strong>Arg3</strong> – Constant multiplier</li>
<li><strong>Arg4</strong> – Result byte</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>It is your responsibility to ensure that the result doesn’t overflow the
size of a byte.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">use_multiply8xk_small(</span><span class="s">mul8k5</span><span class="p">,</span> <span class="s">s0</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="s">s4</span><span class="nb">)</span>  <span class="c">; s4 = s0 * 5</span>
<span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="m">7&#39;d</span>
<span class="k">call</span> <span class="n">mul8k5</span>  <span class="c">; 7 * 5 =&gt; 35</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.use_packed_strings">
<code class="descname">use_packed_strings</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em>, <em>Arg4</em>, <em>Arg5</em>, <em>Arg6</em><span class="optional">[</span>, <em>Arg7</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_packed_strings" title="Permalink to this definition">¶</a></dt>
<dd><p>Configure packed string handling.</p>
<p>This uses string data packed into INST statements stored in big-endian order.
You must provide a routine to read pairs of characters from a dual-ported memory.
The packed_string() macro calls into a generic handler routine that
scans for a NUL terminator on data read from an external ROM.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Register to store even characters</li>
<li><strong>Arg2</strong> – Register to store odd characters</li>
<li><strong>Arg3</strong> – Register for MSB of address to string</li>
<li><strong>Arg4</strong> – Register for LSB of address to string</li>
<li><strong>Arg5</strong> – Label of user provided function to process each character (Only needs to handle the even char register)</li>
<li><strong>Arg6</strong> – Label of user provided function to read pairs of characters from memory</li>
<li><strong>Arg7</strong> – Optional name of macro to generate strings (default is “packed_string”)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">use_packed_strings(</span><span class="s">s0</span><span class="p">,</span> <span class="s">s1</span><span class="p">,</span> <span class="s">s5</span><span class="p">,</span><span class="s">s4</span><span class="p">,</span> <span class="s">write_char</span><span class="p">,</span> <span class="s">read_next_chars</span><span class="nb">)</span>
<span class="c">; read_next_chars is called until a NUL is found</span>
<span class="c">; write_char is called for each character stored in s0</span>
</pre></div>
</div>
<p>This generates a new macro with the name used for Arg7.
You must take steps to ensure that the normal execution path skips the
instructions generated by this macro.
It takes the following arguments:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Label used to identify string</li>
<li><strong>Arg2</strong> – String value. This can contain all of the escape chars supported by estr/cstr</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="k">jump</span> <span class="n">main</span>
    <span class="nb">packed_string(</span><span class="s">my_string</span><span class="p">,</span> <span class="s">`Hello</span><span class="p">,</span> <span class="s">World!\r\n&#39;</span><span class="nb">)</span>
<span class="nl">main:</span>
...
    <span class="k">call</span> <span class="n">my_string</span> <span class="c">; Output the string</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.use_random16">
<code class="descname">use_random16</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em>, <em>Arg4</em>, <em>Arg5</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_random16" title="Permalink to this definition">¶</a></dt>
<dd><p>16-bit pseudo-random number generator.
Based on George Marsaglia’s xorshift algorithm. This generates a full cycle of 65535 values.
Expands to 23 instructions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Label to use for random function</li>
<li><strong>Arg2</strong> – MSB of 16-bit random state variable (Initialize this with a non-zero seed)</li>
<li><strong>Arg3</strong> – LSB of 16-bit random state variable (Initialize this with a non-zero seed)</li>
<li><strong>Arg4</strong> – MSB of a 16-bit internal temp register</li>
<li><strong>Arg5</strong> – LSB of a 16-bit internal temp register</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">reg16(</span><span class="s">RS</span><span class="p">,</span> <span class="s">s0</span><span class="p">,</span><span class="s">s1</span><span class="nb">)</span>
<span class="nb">use_random16(</span><span class="s">random</span><span class="p">,</span> <span class="s">RS</span><span class="p">,</span> <span class="s">sA</span><span class="p">,</span> <span class="s">sB</span><span class="nb">)</span>
...
<span class="nb">load16(</span><span class="s">RS</span><span class="p">,</span> <span class="mh">0x1234</span><span class="nb">)</span>   <span class="c">; Seed the PRNG (Use an external entropy source like an ADC in real life)</span>
<span class="k">call</span> <span class="n">random</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.use_random8">
<code class="descname">use_random8</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_random8" title="Permalink to this definition">¶</a></dt>
<dd><p>8-bit pseudo-random number generator.
Based on George Marsaglia’s xorshift algorithm. Generates a full cycle of 255 values.
Expands to 11 instructions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – label to use for random function</li>
<li><strong>Arg2</strong> – Random state variable (Initialize this with a non-zero seed)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The common temp register is destructively modified.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="k">namereg</span> <span class="n">s8</span><span class="p">,</span> <span class="n">RS</span>
<span class="nb">use_random8(</span><span class="s">random</span><span class="p">,</span> <span class="s">RS</span><span class="nb">)</span>
...
<span class="k">load</span> <span class="n">RS</span><span class="p">,</span> <span class="mh">5A</span>   <span class="c">; Seed the PRNG (Use an external entropy source like an ADC in real life)</span>
<span class="k">call</span> <span class="n">random</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.use_stack">
<code class="descname">use_stack</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_stack" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize and define stack pointer register.</p>
<p><strong>Only invoke once. Must be executed before any push() or pop() macros</strong></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Stack pointer register</li>
<li><strong>Arg2</strong> – Scratchpad address for top of stack</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="k">namereg</span> <span class="n">sA</span><span class="p">,</span> <span class="n">SP</span>      <span class="c">; Reserve stack pointer register</span>
<span class="nb">use_stack(</span><span class="s">SP</span><span class="p">,</span> <span class="mh">0x3F</span><span class="nb">)</span> <span class="c">; Start stack at end of 64-byte scratchpad</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.use_strings">
<code class="descname">use_strings</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em>, <em>Arg4</em><span class="optional">[</span>, <em>Arg5</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_strings" title="Permalink to this definition">¶</a></dt>
<dd><p>Configure string handling for either PB3 or PB6.</p>
<p>This will set up a string output function for either platform
On PB6, the string() macro calls into a generic handler routine that
scans for a NUL terminator.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Register to store each character</li>
<li><strong>Arg2</strong> – Register for MSB of address to string (Only used on PB6)</li>
<li><strong>Arg3</strong> – Register for LSB of address to string (Only used on PB6)</li>
<li><strong>Arg4</strong> – Label of user provided function to process each character</li>
<li><strong>Arg5</strong> – Optional name of macro to generate strings (default is “string”)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">use_strings(</span><span class="s">s0</span><span class="p">,</span> <span class="s">s5</span><span class="p">,</span><span class="s">s4</span><span class="p">,</span> <span class="s">write_char</span><span class="nb">)</span>
  <span class="c">; write_char is called for each character stored in s0 using the &quot;string()&quot; macro</span>
<span class="nb">use_strings(</span><span class="s">s1</span><span class="p">,</span> <span class="s">s5</span><span class="p">,</span> <span class="s">s4</span><span class="p">,</span> <span class="s">write_char_to_console</span><span class="p">,</span> <span class="s">console_str</span><span class="nb">)</span>
  <span class="c">; write_char_to_console is called for each character stored in s1 using the &quot;console_str()&quot; macro</span>
</pre></div>
</div>
<p>This generates a new macro with the name used for Arg5.
You must take steps to ensure that the normal execution path skips the
instructions generated by this macro.
It takes the following arguments:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Label used to identify string</li>
<li><strong>Arg2</strong> – String value. This can contain all of the escape chars supported by estr/cstr</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="k">jump</span> <span class="n">main</span>
    <span class="nb">string(</span><span class="s">my_string</span><span class="p">,</span> <span class="s">`Hello</span><span class="p">,</span> <span class="s">World!\r\n&#39;</span><span class="nb">)</span>
<span class="nl">main:</span>
...
    <span class="k">call</span> <span class="n">my_string</span> <span class="c">; Output the string</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.use_tempreg">
<code class="descname">use_tempreg</code><span class="sig-paren">(</span><em>Arg1</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_tempreg" title="Permalink to this definition">¶</a></dt>
<dd><p>Define a common temporary register used by other macros.
This allows you to change the temp register from its default of <code class="docutils literal"><span class="pre">sE</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Register to use for temp register</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">use_tempreg(</span><span class="s">sA</span><span class="nb">)</span>
<span class="k">load</span> <span class="n">_tempreg</span><span class="p">,</span> <span class="mh">01</span> <span class="c">; Puts 0x01 into sA</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.var_count_ms">
<code class="descname">var_count_ms</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.var_count_ms" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate 16-bit millisecond count for variable delay macro var_delay_ms().</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Milliseconds to delay</li>
<li><strong>Arg2</strong> – Max milliseconds for the delay loop (from definition using var_delay_ms())</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="macro">
<dt id="pb.var_count_us">
<code class="descname">var_count_us</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.var_count_us" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate 16-bit microsecond count for variable delay macro var_delay_us().</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Microseconds to delay</li>
<li><strong>Arg2</strong> – Max microseconds for the delay loop (from definition using var_delay_us())</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="macro">
<dt id="pb.var_delay_ms">
<code class="descname">var_delay_ms</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.var_delay_ms" title="Permalink to this definition">¶</a></dt>
<dd><p>Variable delay by milliseconds</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Maximum milliseconds to delay</li>
<li><strong>Arg2</strong> – MSB of delay counter</li>
<li><strong>Arg3</strong> – LSB of delay counter</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The var_count_ms() macro generates a 16-bit count value that is loaded
into the counter registers before calling the delay function.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre> <span class="nb">use_clock(</span><span class="m">50</span><span class="nb">)</span> <span class="c">; 50 MHz clock</span>
 <span class="nb">define(</span><span class="s">MAXDELAY</span><span class="p">,</span> <span class="m">10</span><span class="nb">)</span> <span class="c">; 10ms max delay</span>
 <span class="nb">reg16(</span><span class="s">dly_count</span><span class="p">,</span> <span class="s">s4</span><span class="p">,</span><span class="s">s5</span><span class="nb">)</span>

<span class="nl">delay:</span> <span class="nb">var_delay_ms(</span><span class="s">MAXDELAY</span><span class="p">,</span> <span class="s">dly_count</span><span class="nb">)</span>
       <span class="k">return</span>
...
<span class="nb">load16(</span><span class="s">dly_count</span><span class="p">,</span> <span class="nb">var_count_ms(</span><span class="m">1</span><span class="p">,</span> <span class="s">MAXDELAY</span><span class="nb">))</span>
<span class="k">call</span> <span class="n">delay</span> <span class="c">; Delay for 1 ms</span>
...
<span class="nb">load16(</span><span class="s">dly_count</span><span class="p">,</span> <span class="nb">var_count_ms(</span><span class="m">8</span><span class="p">,</span> <span class="s">MAXDELAY</span><span class="nb">))</span>
<span class="k">call</span> <span class="n">delay</span> <span class="c">; Delay for 8 ms</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.var_delay_us">
<code class="descname">var_delay_us</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.var_delay_us" title="Permalink to this definition">¶</a></dt>
<dd><p>Variable delay by microseconds.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Maximum microseconds to delay</li>
<li><strong>Arg2</strong> – MSB of delay counter</li>
<li><strong>Arg3</strong> – LSB of delay counter</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The var_count_us() macro generates a 16-bit count value that is loaded
into the counter registers before calling the delay function.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre> <span class="nb">use_clock(</span><span class="m">50</span><span class="nb">)</span> <span class="c">; 50 MHz clock</span>
 <span class="nb">define(</span><span class="s">MAXDELAY</span><span class="p">,</span> <span class="m">900</span><span class="nb">)</span> <span class="c">; 900 us max delay</span>
 <span class="nb">reg16(</span><span class="s">dly_count</span><span class="p">,</span> <span class="s">s4</span><span class="p">,</span><span class="s">s5</span><span class="nb">)</span>

<span class="nl">delay:</span> <span class="nb">var_delay_us(</span><span class="s">MAXDELAY</span><span class="p">,</span> <span class="s">dly_count</span><span class="nb">)</span>
       <span class="k">return</span>
...
<span class="nb">load16(</span><span class="s">dly_count</span><span class="p">,</span> <span class="nb">var_count_us(</span><span class="m">100</span><span class="p">,</span> <span class="s">MAXDELAY</span><span class="nb">))</span>
<span class="k">call</span> <span class="n">delay</span> <span class="c">; Delay for 100 us</span>
...
<span class="nb">load16(</span><span class="s">dly_count</span><span class="p">,</span> <span class="nb">var_count_us(</span><span class="m">800</span><span class="p">,</span> <span class="s">MAXDELAY</span><span class="nb">))</span>
<span class="k">call</span> <span class="n">delay</span> <span class="c">; Delay for 800 us</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.vars">
<code class="descname">vars</code><span class="sig-paren">(</span><em>Arg1-ArgN</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.vars" title="Permalink to this definition">¶</a></dt>
<dd><p>Define variables.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1-ArgN</strong> – Series of variable alias expressions where an alias expression is:
&lt;reg&gt; is &lt;alias&gt; [:= value]</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The alias becomes an alternate name for the register. It is loaded with a value if the
optional initializer is included. The value can be any constant expression or register.
Use the popvars() macro to remove the variable definitions.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">vars(</span><span class="s">s0</span> <span class="s">is</span> <span class="s">counter</span> <span class="o">:=</span> <span class="m">0</span><span class="p">,</span> <span class="s">s1</span> <span class="s">is</span> <span class="s">sum</span><span class="p">,</span> <span class="s">s2</span> <span class="s">is</span> <span class="s">max</span> <span class="o">:=</span> <span class="m">20</span><span class="o">*</span><span class="m">3</span><span class="nb">)</span>
<span class="c">; s0 is loaded with 0</span>
<span class="c">; s2 is loaded with 60</span>
<span class="c">; Three macros &quot;counter&quot;, &quot;sum&quot;, and &quot;max&quot; will expand into their registers</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.warnmsg">
<code class="descname">warnmsg</code><span class="sig-paren">(</span><em>Arg1</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.warnmsg" title="Permalink to this definition">¶</a></dt>
<dd><p>Print a warning message and continue.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – message string</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>This prints a message with the file and line number where the macro was invoked for debugging.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">warnmsg(</span><span class="s">`Bad</span> <span class="s">arguments</span> <span class="s">to</span> <span class="s">foo</span> <span class="s">macro&#39;</span><span class="nb">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.while">
<code class="descname">while</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.while" title="Permalink to this definition">¶</a></dt>
<dd><p>While loop.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1</strong> – Boolean comparison expression</li>
<li><strong>Arg2</strong> – Code block for loop body</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The Boolean expression must be of the form: <code class="docutils literal"><span class="pre">reg</span> <span class="pre">op</span> <span class="pre">reg|expression</span></code> where op is &lt;, &gt;=, ==, !=, &amp;, or ~&amp;</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="mh">00</span>
<span class="nb">while(</span><span class="s">s0</span> <span class="o">&lt;</span> <span class="m">10</span><span class="p">,</span> <span class="s">`output</span> <span class="s">s3</span><span class="p">,</span> <span class="s">P_foo</span>
                <span class="s">add</span> <span class="s">s0</span><span class="p">,</span> <span class="m">01</span><span class="s">&#39;</span><span class="nb">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.words_be">
<code class="descname">words_be</code><span class="sig-paren">(</span><em>Arg1-ArgN</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.words_be" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert 16-bit words into bytes with big-endian order.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1-ArgN</strong> – Numbers to split into bytes</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">words_be(</span><span class="mh">0xff01</span><span class="p">,</span> <span class="mh">0xff02</span><span class="nb">)</span> <span class="c">; Expands to 1, 255, 2, 255</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.words_le">
<code class="descname">words_le</code><span class="sig-paren">(</span><em>Arg1-ArgN</em><span class="sig-paren">)</span><a class="headerlink" href="#pb.words_le" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert 16-bit words into bytes with little-endian order.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Arg1-ArgN</strong> – Numbers to split into bytes</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">words_le(</span><span class="mh">0xff01</span><span class="p">,</span> <span class="mh">0xff02</span><span class="nb">)</span> <span class="c">; Expands to 255, 1, 255, 2</span>
</pre></div>
</div>
</dd></dl>

<dl class="macro">
<dt id="pb.xor16">
<code class="descname">xor16</code><span class="sig-paren">(</span><em>Arg1</em>, <em>Arg2</em>, <em>Arg3</em><span class="optional">[</span>, <em>Arg4</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.xor16" title="Permalink to this definition">¶</a></dt>
<dd><p>16-bit logical XOR.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Arg1</strong> – MSB1</li>
<li><strong>Arg2</strong> – LSB1</li>
<li><strong>Arg3</strong> – Decimal constant or expression or MSB2 when Arg4 is present</li>
<li><strong>Arg4</strong> – Optional register for LSB2</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Result in Arg1, Arg2</p>
</td>
</tr>
</tbody>
</table>
<p>When three arguments are passed, Arg3 is a constant literal. When four arguments are passed,
Arg3 and Arg4 are a 16-bit pair to XOR to the result.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze"><div class="highlight"><pre><span class="nb">load16(</span><span class="s">s1</span><span class="p">,</span><span class="s">s0</span><span class="p">,</span> <span class="mh">0x5A01</span><span class="nb">)</span>
<span class="nb">xor16(</span><span class="s">s1</span><span class="p">,</span><span class="s">s0</span><span class="p">,</span> <span class="mh">0xF0FF</span><span class="nb">)</span>   <span class="c">; Result is 0xAAFE</span>
<span class="nb">xor16(</span><span class="s">s1</span><span class="p">,</span><span class="s">s0</span><span class="p">,</span> <span class="s">s3</span><span class="p">,</span><span class="s">s2</span><span class="nb">)</span>    <span class="c">; (s1,s0) XOR (s3,s2)</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/opbasm_logo.png" alt="Logo"/>
            </a></p>
<h1 class="logo"><a href="../index.html">Opbasm</a></h1>



<p class="blurb">Advanced PicoBlaze Assembler</p>



<p>
<iframe src="https://ghbtns.com/github-btn.html?user=kevinpt&repo=opbasm&type=watch&count=true&size=large"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>


<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="opbsim.html" title="previous chapter">Opbsim</a></li>
  </ul></li>
</ul>
</div><h3>Other projects</h3>

<div id="proj_list">
<p>

<a href="http://kevinpt.github.io/ripyl/">Ripyl</a><br>
<a href="http://code.google.com/p/vertcl">Vertcl</a><br>
<a href="http://code.google.com/p/vhdl-extras">Vhdl-extras</a><br>
<a href="http://kevinpt.github.io/lecroy-colorizer/">Lecroy-colorizer</a>
</p>
</div>

<script>
$(function() { // Retrieve list of repositories from Github and dynamically insert them into sidebar

if(!window.sessionStorage || !JSON) { return; } // Punt on crusty browsers (looking at you IE10)

function JSONP( url, callback ) {
	var id = ( 'jsonp' + Math.random() * new Date() ).replace('.', '');
	var script = document.createElement('script');
	script.src = url.replace( 'callback=?', 'callback=' + id );
	document.body.appendChild( script );
	window[ id ] = function( data ) {
		if (callback) {
			callback( data );
		}
	};
}

// Build dictionary indexing lower cased project names with their preferred format
var knownProjects = ["VHDL-extras", "Ripyl", "VerTcl", "LeCroy-colorizer", "Opbasm"];
var projectDict = {};
$.each(knownProjects, function(index, v) {
  projectDict[v.toLowerCase()] = v;
});

function insert_projects(projects) {
    var links = [];
    var cur_proj = "Opbasm".toLowerCase();
    
    $.each(projects, function(key, value) {
      if(key != cur_proj) {
        var title;
        if(key in projectDict) {
          title = projectDict[key];
        } else { // Capitalize first char
          title = key.replace(/^./, function(match) {return match.toUpperCase()});
        }
        links.push("<a href='"+ value +"'>" + title + "</a>");
      }
    });
    
    $("#proj_list").html("<p>"+ links.join("<br>") +"</p>");
}

var now = new Date().getTime();
if(sessionStorage.KTcacheTime && now - sessionStorage.KTcacheTime < 5*60*1000 ) { // Use cached values (5 min. expiry)
  insert_projects(JSON.parse(sessionStorage.KTprojects));
} else { // Retrieve current projects
  JSONP("https://api.github.com/users/kevinpt/repos?type=owner&callback=?", function(response) {
    var projects = {};
    $.each(response.data, function(index, value) {
      if(!value.fork)
        projects[value.name] = value.homepage;
    });
    
    insert_projects(projects);
    
    // Store data in session cache
    sessionStorage.KTprojects = JSON.stringify(projects);
    var now = new Date().getTime();
    sessionStorage.KTcacheTime = now;
  });  
}

});
</script>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Kevin Thibedeau.
      
      |
      <a href="../_sources/rst/library.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>